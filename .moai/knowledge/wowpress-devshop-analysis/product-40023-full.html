<html class="fa-events-icons-failed" lang="ko"><head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
	<meta http-equiv="p3p" content="CP=&quot;CAO DSP AND SO &quot; policyref=&quot;/w3c/p3p.xml&quot;">
	<meta http-equiv="cache-control" content="no-cache">
	<title>WOWPRESS E-Commerce</title>
	<link rel="shortcut icon" type="image/x-icon" href="/res/favicon.ico">

	









<!-- head.jsp -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js" integrity="sha256-eTyxS0rkjpLEo16uXTS0uVCS4815lc40K2iVpWDvdSY=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
<script src="/asset/plugins/select2/dist/js/select2.min.js"></script>
<script src="/asset/plugins/select2/dist/js/i18n/ko.js"></script>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script src="/plugins/jsonpath/dist/index-browser-umd.cjs"></script>
<script src="/plugins/json-grid-master/JSONGrid.js"></script>
<link href="/asset/plugins/json-grid-master/json-grid.css" rel="stylesheet">
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link href="/asset/plugins/select2/dist/css/select2.min.css" rel="stylesheet">
<link href="/plugins/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<!-- datetimepicker -->
<link rel="stylesheet" type="text/css" href="/plugins/datetimepicker-master/build/jquery.datetimepicker.min.css">
<script src="/plugins/datetimepicker-master/build/jquery.datetimepicker.full.min.js"></script>

<style>
	* {font-size: 0.95rem;}
	 pre {outline: 1px solid #ccc; padding: 5px; margin: 5px; }
	.string { color: green; }
	.number { color: darkorange; }
	.boolean { color: blue; }
	.null { color: magenta; }
	.key { color: red; }
		@import url(https://fonts.googleapis.com/css?family=Nanum+Gothic); 
	body {
		font-size: 13px;
	    font-family: 'Nanum Gothic', sans-serif; 
	}
</style>	
</head>
<body id="body_main" class="bg-dark text-white">
		<!--	header	-->
			














<!-- user header.jsp -->
	<div class="container-fluid">
		<div>
			&nbsp; &nbsp;			
			
				
				 	<span class="bg-danger font-weight-bold text-white">||운영서버접속중||</span>
				
				
				
			

		
			| <span id="uid">innojini</span>(<span id="uname">신우진</span>) 
			<!-- / <span id="ukind"></span> 
			/ <span id="uamtblc"></span> --> 
			/ <a href="javascript:void(0);" onclick="location.href='/userlogout'">로그아웃</a>			
			
				|| <a href="https://api.wowpress.co.kr/docs/apidocs.html?v=1"> <i class="bi bi-gear-wide-connected"></i>API Doc</a> 
				/  <a href="/maint"><i class="bi bi-house"></i>홈으로</a>   
				/  <a href="/mypage/cart/list"><i class="bi bi-cart"></i>바구니</a>
				/  <a href="/mypage/ord/list"><i class="bi bi-truck"></i>주문목록</a>
				<!-- /   <a href="/mypage/ord/list" style="display:none;"><i class="bi bi-truck"></i>주문목록</a> 2025/04/28 조재만. 숨김 / 지움 -->
			
		</div>		
	</div>

<script type="text/javascript">
$(function() {
	loadusrinfo();
});

function loadusrinfo(){
	var form_data = {};
	var options ={};
	options.type = 'post';
	options.form_data = form_data;
	options.url = '/usrinfo';
	options.callbackfunc = set_usrinfo; //result_ord_request; //callback
	httpclient(options);
}

function set_usrinfo(data){

	// 2025/07/09 조재만 추가 // 로그아웃 시 자동으로 로그인 화면으로.
	if (!data || !data.usrinfo) {
		//alert("세션이 만료되었습니다. 로그인 페이지로 이동합니다.");
		window.location.href = "/loginform";
	}

	console.log('set_usrinfo...!!!!');
	console.log(data);
	var usrinfo = data.usrinfo;
	$('#uname').html(usrinfo.mpagInfoMap.Name);
	$('#uid').html(usrinfo.mpagInfoMap.Uid);
	$('#ukind').html(usrinfo.mpagInfoMap.CostKDName);
	$('#uamtblc').html(usrinfo.mpagMainMap.Balance);
}
</script>

<script type="text/javascript">

/*************************************
 * Common Functions
 ************************************/
function httpclient(options){
	var type = options.type; if(type==null)type="GET";
	var url = options.url;	
	var idx = options.idx;
	var form_data = options.form_data;
	var callbackfunc = options.callbackfunc;
	console.log('###=====> header.jsp httpclient ###');
	console.log(form_data);
	console.log('### header.jsp httpclient <=====###');
	$.ajax({
		type : type,			
		url : url,
		data : !isEmpty(form_data)?JSON.stringify(form_data):null, // json string data for form_data
		contentType : 'application/json',
		dataType : 'json',
		success : function(data) {			
			if(callbackfunc!=null){
				data.idx=idx;
				callbackfunc(data);				
			}
		},
		error : function(request, status, error) {
			alert('오류가 발생했습니다. check log.. showlog(); ');
			console.log(request);
			console.log("\n");
			console.log("code:" + request.status + "\n" + "message:"
					+ request.responseText + "\n" + "error:" + error);			
		}
	});
}

var clickCopy = function(obj) {
	const elem = document.createElement('textarea');
	if (obj != "Object") {
		console.log(obj.innerText);
		elem.value = obj.innerText;
		document.body.appendChild(elem);
	   	elem.select();
	   	document.execCommand('copy');
	   	document.body.removeChild(elem);
	   	
	}
}

function output(outobj, inp) {
	outobj.html(inp);
}

function syntaxHighlight(json) {
	if (typeof json != 'string') {
		json = JSON.stringify(json, undefined, 2);
	}
	json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g,
			'&gt;');
	return json
			.replace(
					/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*=)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,
					function(match) {
						var cls = 'number';
						if (/^"/.test(match)) {
							if (/=$/.test(match)) {
								cls = 'key';
							} else {
								cls = 'string';
							}
						} else if (/true|false/.test(match)) {
							cls = 'boolean';
						} else if (/null/.test(match)) {
							cls = 'null';
						}
						return '<span class="' + cls + '">' + match
								+ '</span>';
					});
}


//console log 출력 여부
var wowlogger = function()
{
    var _wow_fn_save_clw = null;
    var _wow_fn_logger = {};

    _wow_fn_logger.log = function log(_log) {
    	if(_wow_fn_save_clw == null) console.log(_log);
    	else _wow_fn_save_clw(_log);
    }
    _wow_fn_logger.enable_clw = function enable_clw() {
    	if(_wow_fn_save_clw == null) return;
    	window['console']['log'] = _wow_fn_save_clw;
    };
    _wow_fn_logger.disenable_clw = function disableLogger() {
    	_wow_fn_save_clw = console.log;
    	window['console']['log'] = function() {};
    };
    _wow_fn_logger.setlogger = function setlogger(bEnable) {
    	bEnable ? this.enable_clw() : this.disenable_clw();
    }
    return _wow_fn_logger;
}();

// console.log 사용 설정
var showlog = function() {
	wowlogger.setlogger(true);
	window.localStorage.setItem('wconsole', true);
}
var setlog = function(isShow) {
	if(isShow=='true'||isShow==true||isShow==1){
		wowlogger.setlogger(true);
		window.localStorage.setItem('wconsole', true);		
	}else{
		wowlogger.setlogger(false);
		window.localStorage.setItem('wconsole', false);
	}
}



function isEmpty(str){
	if(typeof str == 'number')	
		return false;
	else if(typeof str == "undefined" || str == null || str == "")
		return true;
	else
		return false ;
}

function isEmptyNull(str){
	if(typeof str == "undefined" || str == null || str == "" || str == "null")
		return true;
	else
		return false ;
}

function nvl(str, defaultVal) {
	var defaultValue = "";
	if (typeof defaultVal != 'undefined') {
		defaultValue = defaultVal;
	}
	if (typeof str == "undefined" || str == null || str == '' || str == "undefined") {
		return defaultValue;
	}
	return str;
}	
</script>

		<!--	//header	-->
		<!--	content	-->
			










<div class="container-fluid">
	<div class="m-2 mt-3" style="width: 98%;">
		<div class="row">
			<div class="col-5">
				<div class="alert alert-primary p-2">
					제품 단가 조회 및 주문 :
					prodno = <span id="prodno">40023</span> /
					prodname = <span id="prodname">아크릴보드</span> /
						<button type="button" class="btn btn-secondary p-1" onclick="javascript: document.location = '/maint';">제품목록</button>
						<button type="button" class="btn btn-primary p-1" onclick="btnOrd('all','calc'); $('#nav-price-tab').trigger('click');">가격조회</button>
						<button type="button" class="btn btn-warning p-1" onclick="addBasket();">바구니담기</button>
						<button type="button" class="btn btn-info p-1" onclick="addSample();">샘플 담기</button>
						<button type="button" class="btn btn-success p-1" onclick="$('#nav-ord-tab').trigger('click');">주문요청</button>
				</div>

				<!-- 주문 화면 구성 -->
				<div id="display_prod"><div class="alert alert-secondary p-1">인쇄옵션</div><div id="p0_cvcd" class="w-100"><div class="row py-1" id="#p0_cvcd0"></div><div class="col-12 "><div class="row mb-2"><label class="col-form-label col-2">인쇄 </label><div class="col-auto"><select class="form-select" id="p0_hd_00_prs" onchange="chgopt(this);"><option value="30">분류</option></select></div></div></div><div class="col-12"><div class="row mb-2"><label class="col-form-label col-2">규격</label><div class="col-auto"><select class="form-select" id="p0_hd_00_szno" onchange="chgopt(this);"><option value="5683">16절(B5)</option><option value="5680">2절(B2)</option><option value="5684">32절(B6)</option><option value="5681">4절(B3)</option><option value="5682">8절(B4)</option><option value="5675">A1(국전)</option><option value="5676">A2(국2절)</option><option value="5677">A3(국4절)</option><option value="5678">A4(국8절)</option><option value="5679">A5(국16절)</option></select></div><label class="col-auto col-form-label">재단</label><div class="col-auto"><input type="text" class="form-control" maxlength="8" size="8" value="182" id="p0_hd_00_szno_x" onchange="chgopt(this);" readonly="readonly" style=""> </div><label class="col-auto col-form-label">X</label><div class="col-auto"><input type="text" class="form-control" maxlength="8" size="8" value="257" id="p0_hd_00_szno_y" onchange="chgopt(this);" readonly="readonly" style=""> </div></div></div><div class="col-12"><div class="row mb-2"><label class="col-form-label col-2">도수</label><div class="col-10"><div class="row mb-2"><label class="col-form-label col-auto">전면</label><div class="col-auto"><select class="form-select" id="p0_hd_00_clrno" onchange="chgopt(this);"><option value="302">단면 칼라</option></select></div></div></div><div><div></div></div></div></div><div class="col-12"><div class="row mb-2"><label class="col-form-label col-2">지질</label><div class="col-auto"><select class="form-select" id="p0_hd_00_pgno" onchange="chgopt(this);"><option value="21041">아크릴 백색(3T)</option><option value="21042">아크릴 백색(5T)</option><option value="22958">아크릴 투명(3T)</option><option value="22959">아크릴 투명(5T)</option></select></div></div></div><div class="col-12"><div class="row mb-2"><label class="col-form-label col-2">옵션</label><div class="col-auto"><select id="p0_hd_00_optno" class="form-select" onchange="chgopt(this);"><option value="1143">시트지 전면부착</option><option value="1144">시트지 후면부착</option></select> </div></div></div><div class="col-12"><div class="row mb-2"><label class="col-form-label col-2">수량</label><div class="col-auto"><select id="p0_hd_00_ordqty" class="form-select" onchange="chgopt(this);"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option><option value="32">32</option><option value="33">33</option><option value="34">34</option><option value="35">35</option><option value="36">36</option><option value="37">37</option><option value="38">38</option><option value="39">39</option><option value="40">40</option><option value="41">41</option><option value="42">42</option><option value="43">43</option><option value="44">44</option><option value="45">45</option><option value="46">46</option><option value="47">47</option><option value="48">48</option><option value="49">49</option><option value="50">50</option><option value="51">51</option><option value="52">52</option><option value="53">53</option><option value="54">54</option><option value="55">55</option><option value="56">56</option><option value="57">57</option><option value="58">58</option><option value="59">59</option><option value="60">60</option><option value="61">61</option><option value="62">62</option><option value="63">63</option><option value="64">64</option><option value="65">65</option><option value="66">66</option><option value="67">67</option><option value="68">68</option><option value="69">69</option><option value="70">70</option><option value="71">71</option><option value="72">72</option><option value="73">73</option><option value="74">74</option><option value="75">75</option><option value="76">76</option><option value="77">77</option><option value="78">78</option><option value="79">79</option><option value="80">80</option><option value="81">81</option><option value="82">82</option><option value="83">83</option><option value="84">84</option><option value="85">85</option><option value="86">86</option><option value="87">87</option><option value="88">88</option><option value="89">89</option><option value="90">90</option><option value="91">91</option><option value="92">92</option><option value="93">93</option><option value="94">94</option><option value="95">95</option><option value="96">96</option><option value="97">97</option><option value="98">98</option><option value="99">99</option><option value="100">100</option></select> <input type="hidden" id="p0_hd_00_ordcnt" value="1" style=""></div><label class="col-form-label col-auto">개</label></div></div></div></div>

				<div class="card-body" id="btns">
					<button type="button" class="btn btn-secondary" onclick="javascript: document.location = '/maint';">제품목록</button>
					<button type="button" class="btn btn-primary" onclick="btnOrd('all','calc'); $('#nav-price-tab').trigger('click');">가격조회</button>
					<button type="button" class="btn btn-warning p-1" onclick="addBasket();">바구니담기</button>
					<button type="button" class="btn btn-info p-1" onclick="addSample();">샘플 담기</button>
					<button type="button" class="btn btn-success" onclick="$('#nav-ord-tab').trigger('click');">주문요청</button>
					<!-- <button type="button" class="btn btn-warning" onclick="btnOrd('all','cart');">바구니</button> -->
					<!-- <button type="button" class="btn btn-primary" onclick="btnOrd('ord');">주문하기</button> -->
				</div>

			</div>



				<div class="col-7">
					<nav>
						<div class="nav nav-tabs" id="nav-tab" role="tablist" style="height:35px;">
							<button class="nav-link sm active h-100" id="nav-price-tab" data-bs-toggle="tab" data-bs-target="#nav-price" type="button" role="tab" aria-controls="nav-price" aria-selected="false">제품단가</button>
							<button class="nav-link sm h-100" id="nav-ord-tab" data-bs-toggle="tab" data-bs-target="#nav-ord" type="button" role="tab" aria-controls="nav-ord" aria-selected="true">제품 주문</button>
						</div>
					</nav>
					<div class="tab-content mt-2" id="nav-tabContent">
						<div class="tab-pane fade show active" id="nav-price" role="tabpanel" aria-labelledby="nav-price-tab">
							<!-- 단가요청 및 결과 표시 -->
							<div id="reqboard">	<div class="row mt-3">		<hr class="rounded">		</div>	<div class="row">		<div class="col-4">				<div class="row">				<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">					제품단가 확인요청 Send JSON format				</div>					<pre class="editcopy w-100 overflow-auto shadow" id="p0_prettyResult" style="font-size: 0.8rem; max-height: 800px; cursor: pointer;">{
  <span class="string">"prodno"</span>: <span class="number">40023</span>,
  <span class="string">"ordqty"</span>: <span class="string">"5"</span>,
  <span class="string">"ordcnt"</span>: <span class="string">"1"</span>,
  <span class="string">"ordtitle"</span>: <span class="string">"샘플"</span>,
  <span class="string">"ordbody"</span>: <span class="string">"주문메모-memo"</span>,
  <span class="string">"ordkey"</span>: <span class="string">"seq_00000000000000000000000022"</span>,
  <span class="string">"jobpresetno"</span>: <span class="string">"30"</span>,
  <span class="string">"prsjob"</span>: [
    {
      <span class="string">"jobno"</span>: <span class="string">"30"</span>,
      <span class="string">"covercd"</span>: <span class="number">0</span>,
      <span class="string">"sizeno"</span>: <span class="string">"5682"</span>,
      <span class="string">"wsize"</span>: <span class="string">"257"</span>,
      <span class="string">"hsize"</span>: <span class="string">"364"</span>,
      <span class="string">"jobqty"</span>: <span class="string">"5"</span>,
      <span class="string">"paperno"</span>: <span class="string">"22959"</span>,
      <span class="string">"optno"</span>: <span class="string">"1144"</span>,
      <span class="string">"colorno0"</span>: <span class="string">"302"</span>,
      <span class="string">"colorno0add"</span>: <span class="string">""</span>
    }
  ],
  <span class="string">"awkjob"</span>: []
}</pre>				<span class="text-primary">Click Box to Copy!</span>			</div>			<div class="row mt-5">			<div class="alert alert-secondary p-1" style="font-size: 13px; color: black; font-weight: bold;">				제품단가			</div>			<div class="card cart-light shadow p-2  bg-dark border">				<table class="w-100" style="font-size: 14px;">					<colgroup>							<col style="width: 30%;">						<col style="width: ;">					</colgroup>						<tbody>						<tr>							<th>인쇄비</th>							<td><span id="p0_od_00_prscost">124600</span></td>						</tr>							<tr>							<th>부자재비</th>							<td><span id="p0_od_00_addcost">0</span></td>						</tr>							<tr>								<th>후가공비</th>							<td><span id="p0_od_00_awkcost">0</span></td>						</tr>							<tr><th>할인</th>							<td><span id="p0_od_00_dccost">0</span></td>						</tr>							<tr><th>공급가</th>							<td><span id="p0_od_00_supcost">124600</span></td>						</tr>							<tr><th>부가세</th>							<td><span id="p0_od_00_taxcost">12460</span></td>						</tr>							<tr><th><span class="bg-warning text-dark">청구가</span></th>							<td><span id="p0_od_00_bill" class="bg-warning text-dark">137060</span></td>						</tr>						</tbody>					</table>			</div>		</div>		</div>		<div class="col-4">			<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">				제품단가 확인결과 Return JSON format			</div>			<pre class="editcopy w-100 overflow-auto shadow" id="p0_prettyResultCalc" style="font-size: 0.8rem; max-height: 800px;  cursor: pointer;">{
  <span class="string">"timestamp"</span>: <span class="string">"2026-02-22 20:16:45"</span>,
  <span class="string">"status"</span>: <span class="number">200</span>,
  <span class="string">"errmsg"</span>: <span class="string">"성공하였습니다."</span>,
  <span class="string">"ordkey"</span>: <span class="string">"seq_00000000000000000000000022"</span>,
  <span class="string">"ordno"</span>: <span class="null">null</span>,
  <span class="string">"ordsno"</span>: <span class="null">null</span>,
  <span class="string">"ordnum"</span>: <span class="null">null</span>,
  <span class="string">"dboxno"</span>: <span class="null">null</span>,
  <span class="string">"dboxnum"</span>: <span class="null">null</span>,
  <span class="string">"boxseq"</span>: <span class="null">null</span>,
  <span class="string">"prodno"</span>: <span class="number">40023</span>,
  <span class="string">"pjoin"</span>: <span class="number">9</span>,
  <span class="string">"ordqty"</span>: <span class="number">5</span>,
  <span class="string">"ordcnt"</span>: <span class="number">1</span>,
  <span class="string">"ordtitle"</span>: <span class="string">"샘플"</span>,
  <span class="string">"ordbody"</span>: <span class="string">"주문메모-memo"</span>,
  <span class="string">"dlvygrpno"</span>: <span class="null">null</span>,
  <span class="string">"boxcnt"</span>: <span class="number">1</span>,
  <span class="string">"weight_ord"</span>: <span class="number">0.002339</span>,
  <span class="string">"weight_box"</span>: <span class="number">27</span>,
  <span class="string">"exitday"</span>: <span class="number">2</span>,
  <span class="string">"exitdate"</span>: <span class="string">"2026-03-02"</span>,
  <span class="string">"dlvcost_base"</span>: <span class="number">4200</span>,
  <span class="string">"ordcost_price"</span>: <span class="number">124600</span>,
  <span class="string">"ordcost_dc"</span>: <span class="number">0</span>,
  <span class="string">"ordcost_sup"</span>: <span class="number">124600</span>,
  <span class="string">"ordcost_tax"</span>: <span class="number">12460</span>,
  <span class="string">"ordcost_bill"</span>: <span class="number">137060</span>,
  <span class="string">"ordcost_base"</span>: {
    <span class="string">"base_price"</span>: {
      <span class="string">"price_prsjob"</span>: <span class="number">124600</span>,
      <span class="string">"price_awkjob"</span>: <span class="number">0</span>
    },
    <span class="string">"base_dc"</span>: {
      <span class="string">"dc_prod"</span>: <span class="number">0</span>,
      <span class="string">"dc_prsjob"</span>: <span class="number">0</span>,
      <span class="string">"dc_awkjob"</span>: <span class="number">0</span>,
      <span class="string">"dcno_prod"</span>: <span class="null">null</span>
    }
  },
  <span class="string">"prsjob"</span>: [
    {
      <span class="string">"paperno"</span>: <span class="string">"22959"</span>,
      <span class="string">"optno"</span>: <span class="string">"1144"</span>,
      <span class="string">"jobqty"</span>: <span class="string">"5"</span>,
      <span class="string">"hsize"</span>: <span class="string">"364"</span>,
      <span class="string">"jobno"</span>: <span class="string">"30"</span>,
      <span class="string">"covercd"</span>: <span class="number">0</span>,
      <span class="string">"colorno0"</span>: <span class="string">"302"</span>,
      <span class="string">"wsize"</span>: <span class="string">"257"</span>,
      <span class="string">"colorno0add"</span>: <span class="string">""</span>,
      <span class="string">"sizeno"</span>: <span class="string">"5682"</span>,
      <span class="string">"status"</span>: <span class="number">200</span>,
      <span class="string">"calccd"</span>: <span class="number">1</span>,
      <span class="string">"jobcostno"</span>: <span class="number">1656705</span>,
      <span class="string">"cost"</span>: <span class="number">124600</span>,
      <span class="string">"cost1"</span>: <span class="number">124600</span>,
      <span class="string">"cost2"</span>: <span class="number">0</span>,
      <span class="string">"cost3"</span>: <span class="number">0</span>,
      <span class="string">"cost4"</span>: <span class="number">0</span>,
      <span class="string">"weight"</span>: <span class="number">0.0023387</span>,
      <span class="string">"exitday"</span>: <span class="number">0</span>,
      <span class="string">"pagecnt"</span>: <span class="number">1</span>,
      <span class="string">"cutcnt"</span>: <span class="number">1</span>,
      <span class="string">"pgramno"</span>: <span class="number">20500</span>
    }
  ],
  <span class="string">"awkjob"</span>: []
}</pre>			<span class="text-primary">Click Box to Copy!</span>		</div>			<div class="col-4">				<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">					제품단가[합계]					</div>				<div class="card cart-light shadow p-2  bg-dark border">					<table class="w-100" style="font-size: 14px;">						<colgroup>							<col style="width: 30%;">							<col style="width: ;">						</colgroup>						<tbody>								<tr><th>인쇄비</th>									<td><span id="ps_od_00_prscost">124600</span></td>							</tr>							<tr><th>부자재비</th>									<td><span id="ps_od_00_addcost">0</span></td>							</tr>							<tr>								<th>후가공비</th>								<td><span id="ps_od_00_awkcost">0</span></td>							</tr>							<tr><th>할인</th>								<td><span id="ps_od_00_dccost">0</span></td>							</tr>							<tr><th>공급가</th>									<td><span id="ps_od_00_supcost">124600</span></td>							</tr>							<tr><th>부가세</th>									<td><span id="ps_od_00_taxcost">12460</span></td>							</tr>							<tr><th><span class="bg-warning text-dark" "="">청구가</span></th>									<td><span id="ps_od_00_bill" class="bg-warning text-dark">137060</span></td>							</tr>						</tbody>					</table>				</div>					<div id="json-grid"></div>				</div>	</div></div>
						</div>
						<div class="tab-pane fade" id="nav-ord" role="tabpanel" aria-labelledby="nav-ord-tab">
							<div class="row sticky-top">
								<div class="col-4">
									<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">
										배송정보
									</div>
									<div class="card cart-light shadow p-2  bg-dark border">
										<div class="card-body row">
												<div class="col-12">
													<div class="form-group col-md-12">
														<label for="ordkey">주문key</label>
														<!-- <input type="text" class="form-control dlvy" id="ordkey" placeholder="주문seq" value="seq_00000000000000000000000048"> -->
														<input type="text" class="form-control dlvy" id="ordkey" placeholder="주문seq" value="" style="">
													</div>
												</div>
												<div class="col-12">
													<div class="form-group col-md-12">
														<label for="ordtitle">주문제목</label>
														<input type="text" class="form-control dlvy" id="ordtitle" placeholder="주문제목" value="샘플" style="">
													</div>
												</div>
												<div class="col-12">
													<div class="form-group col-md-12">
														<label for="ordmemo">주문메모</label>
														<input type="text" class="form-control dlvy" id="ordmemo" placeholder="주문메모" value="주문메모-memo" style="">
													</div>
												</div>
												<div class="col-12">
													<div class="form-group col-md-12">
														<input type="checkbox" class="dlvy" id="ckaddcost" placeholder="ckaddcost" style="">
														<label for="ckaddcost">별도견적일 경우, 반드시 체크합니다.</label>
													</div>
												</div>
												<div class="col-12">
													<div class="form-group col-md-4">
														<label for="dlvymcd">배송방법</label>
														<select id="dlvymcd" class="form-control dlvy" onchange="changeMethod(this);">
														<option value="0">방문</option><option value="1">배쑝와쑝</option><option value="2">대리배송</option><option value="3">착불택배</option><option value="4" selected="">선불택배</option><option value="5">화물</option><option value="6">착불퀵</option><option value="7">선불퀵</option><option value="8">고속버스</option><option value="12">용달</option></select>
													</div>
													<div class="form-group col-md-4">
														<label for="dlvyno">택배사/배송호차</label>
														<select id="dlvyno" class="form-control dlvy">
															<option value="156">CJ대한통운</option>
															<option value="24">대구본사(방문)</option>
															<option value="501">501호차(배쑝와쑝)</option>
															<option value="116">503(배쑝와쑝)</option>
															<option value="120">502-대구(달서구)-대리배송</option>
															<option value="13">CJ대한통운(착불)</option>
															<option value="14">경동택배(착불)</option>
															<option value="155">일본택배</option>
														</select>
													</div>
												</div>

												<div class="col-12">
													<label for="from">FROM</label>
													<div class="input-group" id="from">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">이름</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="fr_name" placeholder="이름" value="와우프레스" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">전화번호</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="fr_t01" placeholder="" value="" style="">
													  <label class="col-form-label col-auto">-</label>
													  <input type="text" class="form-control dlvy" id="fr_t02" placeholder="1600" value="1600" style="">
													  <label class="col-form-label col-auto">-</label>
													  <input type="text" class="form-control dlvy" id="fr_t03" placeholder="7580" value="7580" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">우편번호</span>
													  </div>
													  <div class="input-group-append">
														  <input type="text" class="form-control dlvy" id="fr_zip" placeholder="42699" value="42699" style="">
													  </div>
													  <div class="input-group-append">
														  <button class="btn btn-primary form-control" type="button" onclick="setPostCode('fr');">검색</button>
													  </div>
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">시군구</span>
													  </div>
													  <div class="input-group append w-25">
													  	<input type="text" class="form-control" id="fr_sd" value="대구광역시" style="">
													  </div>
													  <div class="input-group append w-25">
													  	<input type="text" class="form-control" id="fr_sgg" value="달서구" style="">
													  </div>
													  <div class="input-group append w-25">
													  	<input type="text" class="form-control" id="fr_umd" value="장기동" style="">
													  </div>
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">주소1</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="fr_addr1" placeholder="" value="대구광역시 달서구 장기로 65길 11-5" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">상세주소</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="fr_addr2" placeholder="" value="" style="">
													</div>
													<label for="to">TO</label>
													<div class="input-group" id="to">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">이름</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="to_name" placeholder="이름" value="길동홍" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">전화번호</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="to_t01" placeholder="010" value="010" style="">
													  <label class="col-form-label col-auto">-</label>
													  <input type="text" class="form-control dlvy" id="to_t02" placeholder="5678" value="5678" style="">
													  <label class="col-form-label col-auto">-</label>
													  <input type="text" class="form-control dlvy" id="to_t03" placeholder="1234" value="1234" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">우편번호</span>
													  </div>
													   <div class="input-group-append">
													  	<input type="text" class="form-control dlvy" id="to_zip" placeholder="" value="63563" style="">
													  </div>
													   <div class="input-group-append">
														  <button class="btn btn-primary form-control" type="button" onclick="setPostCode('to');">검색</button>
													  </div>
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">시군구</span>
													  </div>
													  <div class="input-group append w-25">
													  	<input type="text" class="form-control" id="to_sd" value="서울" style="">
													  </div>
													  <div class="input-group append w-25">
													  	<input type="text" class="form-control" id="to_sgg" value="금천구" style="">
													  </div>
													  <div class="input-group append w-25">
													  	<input type="text" class="form-control" id="to_umd" value="가산동" style="">
													  </div>
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">주소1</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="to_addr1" placeholder="" value="서울 금천구 가산디지털2로 53" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">상세주소</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="to_addr2" placeholder="" value="한라시그마밸리xx층 xxx호 (가산동)" style="">
													</div>
													<div class="input-group">
													  <div class="input-group-prepend  w-25">
													    <span class="input-group-text">배송메세지</span>
													  </div>
													  <input type="text" class="form-control dlvy" id="to_dlvymsg" placeholder="" value="문앞에 두세요." style="">
													</div>
												</div>
										</div>
										<button type="button" class="btn btn-success" onclick="btnOrd('all','ord');">주문</button>
									</div>

									<div class="card cart-light shadow p-2  bg-dark border">
										<div class="card-body row">
											<div class="col-12">
												<div class="mb-3">
												  <label for="ordfile" class="form-label">주문파일 업로드</label>
												  <input class="form-control form-control-sm" id="ordfile" type="file" name="file" style="">
												  <input type="hidden" id="ordnum" name="ordnum" style="">
												</div>
											</div>
										</div>
										<button type="button" class="btn btn-warning w-50" onclick="uploadFile();">업로드</button>
									</div>
								</div>
								<div class="col-4">
									<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">
										주문요청 Send JSON format
									</div>
									<pre class="editcopy w-100 overflow-auto shadow" id="prettyOrdParam" style="font-size: 0.8rem; max-height: 800px;  cursor: pointer;">{
  <span class="string">"action"</span>: <span class="string">"ord"</span>,
  <span class="string">"ordreq"</span>: [
    [
      {
        <span class="string">"prodno"</span>: <span class="number">40023</span>,
        <span class="string">"ordqty"</span>: <span class="string">"5"</span>,
        <span class="string">"ordcnt"</span>: <span class="string">"1"</span>,
        <span class="string">"ordtitle"</span>: <span class="string">"샘플"</span>,
        <span class="string">"ordbody"</span>: <span class="string">"주문메모-memo"</span>,
        <span class="string">"ordkey"</span>: <span class="string">"seq_00000000000000000000000017"</span>,
        <span class="string">"jobpresetno"</span>: <span class="string">"30"</span>,
        <span class="string">"prsjob"</span>: [
          {
            <span class="string">"jobno"</span>: <span class="string">"30"</span>,
            <span class="string">"covercd"</span>: <span class="number">0</span>,
            <span class="string">"sizeno"</span>: <span class="string">"5682"</span>,
            <span class="string">"wsize"</span>: <span class="string">"257"</span>,
            <span class="string">"hsize"</span>: <span class="string">"364"</span>,
            <span class="string">"jobqty"</span>: <span class="string">"5"</span>,
            <span class="string">"paperno"</span>: <span class="string">"22959"</span>,
            <span class="string">"optno"</span>: <span class="string">"1144"</span>,
            <span class="string">"colorno0"</span>: <span class="string">"302"</span>,
            <span class="string">"colorno0add"</span>: <span class="string">""</span>
          }
        ],
        <span class="string">"awkjob"</span>: []
      }
    ]
  ],
  <span class="string">"dlvymcd"</span>: <span class="string">"4"</span>,
  <span class="string">"dlvyfr"</span>: {
    <span class="string">"name"</span>: <span class="string">"와우프레스"</span>,
    <span class="string">"tel"</span>: <span class="string">"-1600-7580"</span>,
    <span class="string">"zipcode"</span>: <span class="string">"42699"</span>,
    <span class="string">"sd"</span>: <span class="string">"대구광역시"</span>,
    <span class="string">"sgg"</span>: <span class="string">"달서구"</span>,
    <span class="string">"umd"</span>: <span class="string">"장기동"</span>,
    <span class="string">"addr1"</span>: <span class="string">"대구광역시 달서구 장기로 65길 11-5"</span>,
    <span class="string">"addr2"</span>: <span class="string">""</span>
  },
  <span class="string">"dlvyto"</span>: {
    <span class="string">"name"</span>: <span class="string">"길동홍"</span>,
    <span class="string">"tel"</span>: <span class="string">"010-5678-1234"</span>,
    <span class="string">"zipcode"</span>: <span class="string">"63563"</span>,
    <span class="string">"sd"</span>: <span class="string">"서울"</span>,
    <span class="string">"sgg"</span>: <span class="string">"금천구"</span>,
    <span class="string">"umd"</span>: <span class="string">"가산동"</span>,
    <span class="string">"addr1"</span>: <span class="string">"서울 금천구 가산디지털2로 53"</span>,
    <span class="string">"addr2"</span>: <span class="string">"한라시그마밸리xx층 xxx호 (가산동)"</span>,
    <span class="string">"dlvymsg"</span>: <span class="string">"문앞에 두세요."</span>
  }
}</pre>
									<span class="text-primary">Click Box to Copy!</span>
								</div>
								<div class="col-4">
									<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">
										제품주문 결과 Return JSON format
									</div>
									<pre class="editcopy w-100 overflow-auto shadow" id="prettyResultOrd" style="font-size: 0.8rem; max-height: 800px;  cursor: pointer;"></pre>
									<span class="text-primary">Click Box to Copy!</span>
								</div>

							</div>
						</div>
					</div>
			</div>


		</div>
	</div>
</div>

<script type="text/javascript">
$(function() {
	var isShow = window.localStorage.getItem('wconsole');
	setlog(isShow);
	loadprod('40023');
});
</script>

<script type="text/javascript">

function loadprod(prodno){
	var form_data = null;// {};
	var options ={};
	options.type = 'get';
	options.form_data = form_data;
	options.url = '/std/prod_info/'+prodno;
	options.callbackfunc = set_layouts; //result_ord_request; //callback
	httpclient(options);
}
var prods = new Array();
//var isDsp=false;
function set_layouts(data){
	console.log('set_layouts.......!!!!!!!');
	console.log(data.prod_info);
	console.log(data.prod_info.prodaddinfo);
	var prod = data.prod_info;
	prod.idx = 0;
	prods.push(prod);
	setreqboard(0);//결과layout
	//주문옵션 화면
	var ui_html='';
	ui_html +='<div class="alert alert-secondary p-1">인쇄옵션</div>';
	ui_html +='<div id="p0_cvcd" class="w-100"></div>';
	$('#display_prod').append(ui_html);
	display_prod(prod);
	//info
	$('#prodno').text(prod.prodno);
	$('#prodname').text(prod.prodname);
	//dlvy info()
	setDlvyInfo(prods[0]);

	//부자재
	var addprods = prod.prodaddinfo;
	if(!isEmpty(addprods)){
		for(var idx=0; idx < addprods.length; idx++){
			var addidx = (idx+1);
			setreqboard(addidx); //결과layout
			ui_html='';
			ui_html +='<div class="alert alert-secondary p-1">부자재11: prodno='+addprods[idx].prodno+' / '+addprods[idx].prodname+'</div>';
			ui_html +='<div id="p'+addidx+'_cvcd" class="w-100"></div>';
			$('#display_prod').append(ui_html);
			loadaddprod(addprods[idx].prodno);
		}
	}

	$('.editcopy').on("click", function(e){ clickCopy(this); });//add event

	// 2025/06/27 조재만 제거. 콤보박스
	//$( ".dlvy" ).change(function(obj) {
		getOrdParams();
	//});

	//add_grid
	setTimeout(add_grid,(parseInt(prod.idx)+1)*1000,prod.idx,prod);
}

function setreqboard(idx){
	var ui_html='';
		ui_html+='	<div class="row mt-3">';
		ui_html+='		<hr class="rounded">	';
		ui_html+='	</div>';
		ui_html+='';
		ui_html+='	<div class="row">';
		ui_html+='		<div class="col-4">	';
		ui_html+='			<div class="row">';
		ui_html+='				<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">';
		ui_html+='					제품단가 확인요청 Send JSON format';
		ui_html+='				</div>	';
		ui_html+='				<pre class="editcopy w-100 overflow-auto shadow" id="p'+idx+'_prettyResult" style="font-size: 0.8rem; max-height: 800px; cursor: pointer;"></pre>';
		ui_html+='				<span class="text-primary">Click Box to Copy!</span>';
		ui_html+='			</div>';
		/* ui_html+='			<div class="row  mt-5">';
		ui_html+='				<div class="alert alert-secondary p-1" style="font-size: 13px; color: black; font-weight: bold;">';
		ui_html+='					Response Status	';
		ui_html+='				</div>';
		ui_html+='				<div class="card cart-light shadow p-2">';
		ui_html+='					<table class="w-100" style="font-size: 14px;">';
		ui_html+='						<colgroup>';
		ui_html+='							<col style="width: 30%;">';
		ui_html+='							<col style="width: ;">';
		ui_html+='						</colgroup>';
		ui_html+='						<tbody>	';
		ui_html+='							<tr><th>timestamp</th>';
		ui_html+='								<td><span id="p'+idx+'_od_00_timestamp"></span></td>';
		ui_html+='							</tr>';
		ui_html+='							<tr><th>status</th>';
		ui_html+='								<td><span id="p'+idx+'_od_00_status"></span></td>';
		ui_html+='							</tr>';
		ui_html+='							<tr>';
		ui_html+='								<th>msg</th>';
		ui_html+='								<td><span id="p'+idx+'_od_00_msg"></span></td>';
		ui_html+='							</tr>';
		ui_html+='						</tbody>';
		ui_html+='					</table>	';
		ui_html+='				</div>';
		ui_html+='			</div>'; */
		ui_html+='			<div class="row mt-5">';
		ui_html+='			<div class="alert alert-secondary p-1" style="font-size: 13px; color: black; font-weight: bold;">';
		if(idx==0&&(prods[idx].pjoin==0||idx==0)){
			ui_html+='				제품단가';
		}else{
			ui_html+='				부자재단가';
		}
		ui_html+='			</div>';
		ui_html+='			<div class="card cart-light shadow p-2  bg-dark border">';
		ui_html+='				<table class="w-100" style="font-size: 14px;">';
		ui_html+='					<colgroup>	';
		ui_html+='						<col style="width: 30%;">';
		ui_html+='						<col style="width: ;">';
		ui_html+='					</colgroup>	';
		ui_html+='					<tbody>';
		ui_html+='						<tr>';
		ui_html+='							<th>인쇄비</th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_prscost"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='						<tr>';
		ui_html+='							<th>부자재비</th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_addcost"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='						<tr>	';
		ui_html+='							<th>후가공비</th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_awkcost"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='						<tr><th>할인</th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_dccost"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='						<tr><th>공급가</th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_supcost"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='						<tr><th>부가세</th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_taxcost"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='						<tr><th><span class="bg-warning text-dark">청구가</span></th>';
		ui_html+='							<td><span id="p'+idx+'_od_00_bill" class="bg-warning text-dark"></span></td>';
		ui_html+='						</tr>	';
		ui_html+='					</tbody>	';
		ui_html+='				</table>';
		ui_html+='			</div>';
		ui_html+='		</div>';
		ui_html+='		</div>';
		ui_html+='		<div class="col-4">';
		ui_html+='			<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">';
		ui_html+='				제품단가 확인결과 Return JSON format';
		ui_html+='			</div>';
		ui_html+='			<pre class="editcopy w-100 overflow-auto shadow" id="p'+idx+'_prettyResultCalc" style="font-size: 0.8rem; max-height: 800px;  cursor: pointer;"></pre>';
		ui_html+='			<span class="text-primary">Click Box to Copy!</span>';
		ui_html+='		</div>';
			if(idx==0){
				ui_html+='			<div class="col-4">';
				ui_html+='				<div class="alert alert-secondary p-1" style="font-size: 14px; color: black; font-weight: bold;">';
				ui_html+='					제품단가[합계]	';
				ui_html+='				</div>';
				ui_html+='				<div class="card cart-light shadow p-2  bg-dark border">';
				ui_html+='					<table class="w-100" style="font-size: 14px;">';
				ui_html+='						<colgroup>';
				ui_html+='							<col style="width: 30%;">';
				ui_html+='							<col style="width: ;">';
				ui_html+='						</colgroup>';
				ui_html+='						<tbody>	';
				ui_html+='							<tr><th>인쇄비</th>	';
				ui_html+='								<td><span id="ps_od_00_prscost"></span></td>';
				ui_html+='							</tr>';
				ui_html+='							<tr><th>부자재비</th>	';
				ui_html+='								<td><span id="ps_od_00_addcost"></span></td>';
				ui_html+='							</tr>';
				ui_html+='							<tr>';
				ui_html+='								<th>후가공비</th>';
				ui_html+='								<td><span id="ps_od_00_awkcost"></span></td>';
				ui_html+='							</tr>';
				ui_html+='							<tr><th>할인</th>';
				ui_html+='								<td><span id="ps_od_00_dccost"></span></td>';
				ui_html+='							</tr>';
				ui_html+='							<tr><th>공급가</th>	';
				ui_html+='								<td><span id="ps_od_00_supcost"></span></td>';
				ui_html+='							</tr>';
				ui_html+='							<tr><th>부가세</th>	';
				ui_html+='								<td><span id="ps_od_00_taxcost"></span></td>';
				ui_html+='							</tr>';
				ui_html+='							<tr><th><span class="bg-warning text-dark"">청구가</span></th>	';
				ui_html+='								<td><span id="ps_od_00_bill" class="bg-warning text-dark" ></span></td>';
				ui_html+='							</tr>';
				ui_html+='						</tbody>';
				ui_html+='					</table>';
				ui_html+='				</div>	';
				ui_html+='				<div id="json-grid"></div>	'; //json-grid
				ui_html+='			</div>';
			}
		ui_html+='	</div>';
	$('#reqboard').append(ui_html);

}

function loadaddprod(prodno){
	var form_data = null;// {};
	var options ={};
	options.type = 'get';
	options.form_data = form_data;
	options.url = '/std/prod_info/'+prodno;
	options.callbackfunc = set_addprod; //result_ord_request; //callback
	httpclient(options);
}

	function set_addprod(data){
		var prod = data.prod_info;
		prod.idx = prods.length;
		prods.push(prod);
		display_prod(prod);
		//return;
		//setTimeout(add_grid,(parseInt(prod.idx)+1)*1000,prod.idx,prod); //json-grid
	}

	function add_grid(idx, prod){
		return; //사용중지....

		var grid = 'json-grid-'+idx;
		//json-grid
		$('#json-grid').append('<div id="'+grid+'"></div><br/>');
		var container = document.getElementById(grid);
		var jsonGrid = new JSONGrid(prod, container);
		jsonGrid.render();
	}


	/* 주문옵션 화면 */
	function display_prod(prod){
		var idx = prod.idx;
		var sIdx = 'p'+idx+'_';
		var tIdx = '#p'+idx+'_';
		$(tIdx+'cvcd').text('');
		$(tIdx+'prodno').text(prod.prodno);
		$(tIdx+'prodname').text(prod.prodname);

		// 2025/06/20 조재만 추가 / Ncr인지 아닌지 판별.
		const isNcr = prod.paperinfo?.[0]?.paperlist?.some(p => p.papergroup === "NCR");
		// const isNcr = Array.isArray(prod.paperinfo) &&
		// 		prod.paperinfo[0]?.paperlist?.some(p => p.papergroup === "NCR");
		// 도수
		const colorMapByOpt = {};

		//# prs
		var coverinfo = prod.coverinfo;
		for(var ckey in coverinfo){			//ckey is index 0,1,2,3
			var cover = coverinfo[ckey];

			//#====> cover div
			var tcvcd = tIdx+'cvcd';
			var html_cmmn = '<div class="row py-1" id="'+tcvcd+cover.covercd+'"></div>';	//cover page info
			$(tcvcd).append(html_cmmn);


			if(ckey==0){					//common or display only once
				//#=======================================>prs for pjoin=0?
				var prsinfo = prod.prsjobinfo; //list
				if(!isEmpty(prsinfo)&&!isEmpty(prsinfo[0].jobpresetno)){

					html_cmmn = '<div class="col-12 '+(prod.prodclass=='S'?'d-none':'')+'">';
					html_cmmn += '<div class="row mb-2">';
					html_cmmn += '<label class="col-form-label col-2">인쇄 </label>';
					html_cmmn += '<div class="col-auto">';
					html_cmmn += '<select class="form-select" id="'+sIdx+'hd_'+cover.covercd+'0_prs" onchange="chgopt(this);">';
					for(var pkey in prsinfo){
						var prsg = prsinfo[pkey];
						html_cmmn += '<option value="'+prsg.jobpresetno+'">'+prsg.jobpreset+'</option>';
					}
					html_cmmn += '</select>';
					html_cmmn += '</div></div>';
					$(tcvcd).append(html_cmmn);
				}
				//#<=======================================ps

				//#=======================================> size div
				if(!isEmpty(prod.sizeinfo)){
					var szlist =  prod.sizeinfo[0].sizelist;		//	check always covercd = 0
					var initsz = szlist[0];
					html_cmmn = '<div class="col-12">';
					html_cmmn += '<div class="row mb-2">';
					html_cmmn += '<label class="col-form-label col-2">규격</label>';
					html_cmmn += '<div class="col-auto">';
					html_cmmn += '<select class="form-select" id="'+sIdx+'hd_00_szno" onchange="chgopt(this);" >';
					for(var sskey in szlist){		//skey is index 0,2 ....
						html_cmmn += '<option value="'+szlist[sskey].sizeno+'">'+szlist[sskey].sizename+'</option>';
					}
					html_cmmn +='</select></div>';
					//if(!isEmpty(initsz.width)&&prod.prodclass=='P'){
					if(!isEmpty(initsz.width)){
						html_cmmn +='<label class="col-auto col-form-label">재단</label>';
						html_cmmn +='<div class="col-auto"><input type="text" class="form-control" maxlength="8" size="8" value="'+initsz.width+'" id="'+sIdx+'hd_00_szno_x" onchange="chgopt(this);" '+(initsz.non_standard==false?'readonly':'')+' /> </div>';
						html_cmmn +='<label class="col-auto col-form-label">X</label>';
						html_cmmn +='<div class="col-auto"><input type="text" class="form-control" maxlength="8" size="8" value="'+initsz.height+'" id="'+sIdx+'hd_00_szno_y" onchange="chgopt(this);" '+(initsz.non_standard==false?'readonly':'')+' /> </div>';
					}

					html_cmmn +='</div></div>';
					$(tcvcd).append(html_cmmn);
				}
				//#<======================================= end of size div
				if(prod.pjoin==1){
					//#======================================= > qty for pjoin=1
					if(prod.unit=='매'){
						var iniqty = (prod.ordqty.filter((ordqty)=>{return ordqty.sizeno==initsz.sizeno}))[0];
						html_cmmn = '<div class="col-12">';
						html_cmmn += '<div class="row mb-2">';
						html_cmmn += '<label class="col-form-label col-2">수량</label>';
						html_cmmn += '<div class="col-auto">';
						html_cmmn += '<input class="form-control" type="text" maxlength="5" size="5" value="'+iniqty.ordqtymin+'" id="'+sIdx+'hd_00_ordqty" onchange="chgopt(this);" />';
						html_cmmn += '</div>';
						html_cmmn += '<label class="col-form-label col-auto">'+prod.unit+'</label>';
						html_cmmn += '<label class="col-form-label col-auto">x</label>';
						html_cmmn += '<div class="col-auto"><input class="form-control" type="text" maxlength="5" size="5" value="1" id="'+sIdx+'hd_00_ordcnt" onchange="chgopt(this);" /></div>';
						html_cmmn += '<label class="col-form-label col-auto">건</label>';
						html_cmmn += '</div></div>';
						$(tcvcd).append(html_cmmn);

					}else{ //부 x 건
						html_cmmn = '<div class="col-12">';
						html_cmmn += '<div class="row mb-2">';
						html_cmmn += '<label class="col-form-label col-2">수량</label>';
						html_cmmn += '<div class="col-auto"><select class="form-select" id="'+sIdx+'hd_00_ordqty" onchange="chgopt(this);">';
						//var qtylist = prod.ordqty[0].list;
						var qtylist = prod.ordqty[0].ordqtylist;
						for(var qkey in qtylist){
							html_cmmn += '<option value="'+qtylist[qkey]+'">'+qtylist[qkey]+'</option>';
						}
						html_cmmn += '</select></div>';
						html_cmmn += '<label class="col-form-label col-auto">'+prod.unit+'</label>';
						html_cmmn += '<label class="col-form-label col-auto">x</label>';
						html_cmmn += '<div class="col-auto"><input class="form-control" type="text" maxlength="5" size="5" value="1" id="'+sIdx+'hd_00_ordcnt" onchange="chgopt(this);" /></div>';
						html_cmmn += '<label class="col-form-label col-auto">건</label>';
						html_cmmn += '</div></div>';
						$(tcvcd).append(html_cmmn);
					}
					//#<======================================= end of qty for pjoin=1
				}
			}

			if(prod.pjoin==1&&coverinfo.length>1){
				//html_cmmn = '<div class="m-3"></div>';
				html_cmmn = '';
				html_cmmn += '<div class="row"><div class="col-12"><div class="alert alert-secondary p-1">'+cover.covername+'</div></div></div>';
				$(tcvcd).append(html_cmmn);
			}

			//#=======================================> color (back and forth)
			// if(!isEmpty(prod.colorinfo)){
				// 2025/06/20 조재만 isNcr 추가
			if(!isEmpty(prod.colorinfo) && !isNcr) {

				var colorno;	//init value
				html_cmmn = '<div class="col-12">';
				html_cmmn += '<div class="row mb-2">';
				html_cmmn += '<label class="col-form-label col-2">도수</label>';
				html_cmmn += '<div class="col-10">';

				var cvpglist = prod.colorinfo.find(cvpg => {
					return cvpg.covercd == cover.covercd
				}).pagelist;
				var msg_page = '전면';
				for (var pgk in cvpglist) {  //앞, 뒤
					//color
					var clrlist = cvpglist[pgk].colorlist;
					html_cmmn += '<div class="row mb-2">';
					html_cmmn += '<label class="col-form-label col-auto">' + msg_page + '</label>';
					html_cmmn += '<div class="col-auto">';
					html_cmmn += '<select class="form-select" id="' + sIdx + 'hd_' + cover.covercd + cvpglist[pgk].pagecd + '_clrno" onchange="chgopt(this);">';
					for (var cck in clrlist) {
						//간지는 기본적으로 도수 선택하세요.
						//if(cover.covercd==3){
						if (cck == 0 && cvpglist[pgk].type == 'select')
							html_cmmn += '<option value="">선택하세요</option>';
						html_cmmn += '<option value="' + clrlist[cck].colorno + '">' + clrlist[cck].colorname + '</option>';
					}
					html_cmmn += '</select></div>';

					//& coloradd
					var clraddlist = cvpglist[pgk].coloraddlist;
					if (!isEmpty(clraddlist)) {
						html_cmmn += '<label class="col-form-label col-auto">도수추가</label>';
						html_cmmn += '<div class="col-auto">';
						html_cmmn += '<select class="form-select" id="' + sIdx + 'hd_' + cover.covercd + cvpglist[pgk].pagecd + '_clrno_add" onchange="chgopt(this);">';
						for (var cck in clraddlist) {
							if (cck == 0) html_cmmn += '<option value>도수선택</option>';
							if (cvpglist[pgk].pagecd == 1) {//전면의 추가도수는 같은색일 수 없음
								if (clraddlist[cck].colornoadd != colorno) html_cmmn += '<option value="' + clraddlist[cck].colornoadd + '">' + clraddlist[cck].colorname + '</option>';
							} else {
								html_cmmn += '<option value="' + clraddlist[cck].colornoadd + '">' + clraddlist[cck].colorname + '</option>';
							}
						}
						html_cmmn += '</select></div>';
					}
					html_cmmn += '</div>';
					msg_page = '후면';
				}


				html_cmmn += '</div><div><div>';
				$(tcvcd).append(html_cmmn);
			}

			//#<======================================= color (back and forth)



			//#=======================================> paper
			// 2025/06/20 NCR에서 일 때 API의 UI에서 지질 숨김.
			//if(!isEmpty(prod.paperinfo)){
			if (!isNcr && !isEmpty(prod.paperinfo)) {

				var pplist = paperlist(prod, cover.covercd); //도수에 따라 작업 가능한 종이 목록

				//var pplist = prod.paperinfo[0].paperlist;

				var initpp = pplist[0];		//초기값
				html_cmmn = '<div class="col-12">';
				html_cmmn += '<div class="row mb-2">';
				html_cmmn += '<label class="col-form-label col-2">지질</label>';
				html_cmmn += '<div class="col-auto">';
				html_cmmn += '<select class="form-select" id="'+sIdx+'hd_'+cover.covercd+'0_pgno" onchange="chgopt(this);">';
				for(var ppk in pplist){		//ppk is index 0,2 ....
					//if(ppk==0)paperno=pplist[ppk].paperno;
					html_cmmn += '<option value="'+pplist[ppk].paperno+'">'+pplist[ppk].papername+'</option>';
				}
				html_cmmn += '</select></div>';
				html_cmmn += '</div></div>';
				$(tcvcd).append(html_cmmn);


			}


			// 2025/06/19 조재만 추가 // 상지 중지 하지

			if (isNcr) {
				const paperInfo = prod.paperinfo[0];
				//const paperMasterList = paperInfo.paperlist;
				const ncrInfo = paperInfo.ncr;

				// NCR 매 수에 따라 용지 위치를 정확히 설정
				const paperLists = [];

				paperLists.push({ position: '상지 지질', list: ncrInfo.paper1list, id: 'top' });

				if (Array.isArray(ncrInfo.paper4list) && ncrInfo.paper4list.length > 0) {
					paperLists.push({ position: ncrInfo.paper2list?.[0]?.PaperItem || '중지1 지질', list: ncrInfo.paper2list, id: 'middle1' });
					paperLists.push({ position: ncrInfo.paper3list?.[0]?.PaperItem || '중지2 지질', list: ncrInfo.paper3list, id: 'middle2' });
					paperLists.push({ position: ncrInfo.paper4list?.[0]?.PaperItem || '하지 지질', list: ncrInfo.paper4list, id: 'bottom' });
				} else if (Array.isArray(ncrInfo.paper3list) && ncrInfo.paper3list.length > 0) {
					paperLists.push({ position: ncrInfo.paper2list?.[0]?.PaperItem || '중지 지질', list: ncrInfo.paper2list, id: 'middle1' });
					paperLists.push({ position: ncrInfo.paper3list?.[0]?.PaperItem || '하지 지질', list: ncrInfo.paper3list, id: 'bottom' });
				} else {
					paperLists.push({ position: ncrInfo.paper2list?.[0]?.PaperItem || '하지 지질', list: ncrInfo.paper2list, id: 'bottom' });
				}

				paperLists.forEach(function(info) {
					if (!Array.isArray(info.list) || info.list.length === 0) return;

					const isTop = info.id === 'top'; // 상지 판단
					const selectId = isTop
							? sIdx + 'hd_' + cover.covercd + '0_pgno' // 상지는 서버가 paperno로 파싱
							: sIdx + 'ncr_' + info.id;                // 중지/하지는 joboptmsg 전용

					html_cmmn = '';
					html_cmmn += '<div class="col-12">';
					html_cmmn += '<div class="row mb-2">';
					html_cmmn += '<label class="col-form-label col-2">' + info.position + '</label>';
					html_cmmn += '<div class="col-auto">';

					html_cmmn += '<select class="form-select" id="' + selectId + '" onchange="chgopt(this);" data-ncr-part="' + info.id + '">';

					info.list.forEach(paper => {
						const val = isTop
								? paper.PaperNo // 상지는 paperno를 사용
								: paper.PaperName; // 중지/하지는 PaperName을 사용하여 joboptmsg에 포함

						html_cmmn += '<option value="' + val + '">' + paper.PaperName + '</option>';
					});

					html_cmmn += '</select>';
					html_cmmn += '</div></div></div>';

					$(tcvcd).append(html_cmmn);
				});
			}


			//#<======================================= end of paper

		//#=======================================> ordqty
		if(prod.pjoin==0){
			var oqtlist;
			try{
				oqtlist = currentqty(idx);
				console.log('pjoin...!!');
				console.log(oqtlist);
			}catch(e){console.log(e);}

			html_cmmn = '<div class="col-12">';
			html_cmmn += '<div class="row mb-2">';
			html_cmmn += '<label class="col-form-label col-2">수량</label>';
			html_cmmn += '<div class="col-auto">';
			html_cmmn += '<select class="form-select" id="'+sIdx+'hd_'+cover.covercd+'0_ordqty" onchange="chgopt(this);">';
			for(var qkey in oqtlist){
				html_cmmn += '<option value='+oqtlist[qkey]+'>'+oqtlist[qkey]+'</option>';
			}
			html_cmmn += '</select></div>';
			html_cmmn += '<label class="col-form-label col-auto">'+prod.unit+'</label>';

			//#===================> ordcnt
			html_cmmn += '<label class="col-form-label col-auto">x</label>';
			html_cmmn += '<div class="col-auto">';
			html_cmmn += '<select class="form-select" id="'+sIdx+'hd_00_ordcnt" onchange="chgopt(this);">';
			var ordcnt = prod.ordcntget=='N'? 1:1000;
			for(var cnt=1 ; cnt<(ordcnt+1); cnt++){
				html_cmmn += '<option value="'+cnt+'">'+cnt+'</option>';
			}
			html_cmmn += '</select></div>';
			html_cmmn += '<label class="col-form-label col-auto">건</label>';
			//#<================== end of ordcnt
			html_cmmn += '</div></div>';
			$(tcvcd).append(html_cmmn);
		}
		//#================================> 페이지수
		if(!isEmpty(cover.pagecnt)&&!isEmpty(cover.pagecnt.min)){
			html_cmmn = '<div class="col-12">';
			html_cmmn += '<div class="row mb-2">';
			html_cmmn += '<label class="col-form-label col-2">페이지수</label>';
			html_cmmn += '<div class="col-auto">';
			html_cmmn += '<input type="text" class="form-control" maxlength="5" size="5" value="'+cover.pagecnt.min+'" id="'+sIdx+'hd_'+cover.covercd+'0_pagecnt" onchange="chgopt(this);">';
			html_cmmn += '</div>';
			html_cmmn += '</div>';
			html_cmmn += '</div>';
			$(tcvcd).append(html_cmmn);
		}
		//#<================================>

		//#=======================================> option? 덕구스티커 또는 부자재제품, NCR?
		if(!isEmpty(prod.optioninfo)){
			var optlist;
			try{
				optlist = prod.optioninfo[0].optlist;
			}catch(e){console.log(e);}

			//html_cmmn = '<div>';
			//html_cmmn += '<span class="m-3">옵션</span>';
			html_cmmn = '<div class="col-12">';
			html_cmmn += '<div class="row mb-2">';
			html_cmmn += '<label class="col-form-label col-2">옵션</label>';
			html_cmmn += '<div class="col-auto">';
			html_cmmn += '<select id="'+sIdx+'hd_'+cover.covercd+'0_optno"  class="form-select" onchange="chgopt(this);">';
			for(var qkey in optlist){
				html_cmmn += '<option value='+optlist[qkey].optno+'>'+optlist[qkey].optname+'</option>';
			}
			html_cmmn += '</select> ';
			html_cmmn += '</div>';
			html_cmmn += '</div>';
			html_cmmn += '</div>';
			$(tcvcd).append(html_cmmn);
		}
		//#<======================================= end of option

			// 2025/06/23 조재만 추가
			if (isNcr) {
				const optEl = $('#' + sIdx + 'hd_' + cover.covercd + '0_optno');
				let optno = optEl.val();
				if (!optno) {
					optno = optEl.find('option[value!=""]').first().val();
				}

				const jobpresetno = $(tIdx + 'hd_' + cover.covercd + '0_prs').val();

				const colorMap = new Map();

				prod.colorinfo?.forEach(ci => {
					if (ci.covercd != cover.covercd) return;

					ci.pagelist?.forEach(pg => {
						pg.colorlist?.forEach(cl => {
							const matchJob = cl.req_prsjob?.some(j => String(j.jobpresetno) === String(jobpresetno));
							const blockByOpt = cl.rst_opt?.some(opt => String(opt.optno) === String(optno)) ?? false;

							if (matchJob && !blockByOpt) {
								colorMap.set(cl.colorno, cl.colorname);
							}
						});
					});
				});

				html_cmmn = '<div class="col-12">';
				html_cmmn += '<div class="row mb-2">';
				html_cmmn += '<label class="col-form-label col-2">도수</label>';
				html_cmmn += '<div class="col-auto">';
				html_cmmn += '<select class="form-select form-select-sm w-auto" id="' + sIdx + 'hd_' + cover.covercd + '0_clrno" onchange="chgopt(this);">';

				Array.from(colorMap.entries()).forEach(([colorno, colorname], i) => {
					html_cmmn += '<option value="' + colorno + '"' + (i === 0 ? ' selected' : '') + '>' + colorname + '</option>';
				});

				html_cmmn += '</select>';
				html_cmmn += '</div></div></div>';
				$(tcvcd).append(html_cmmn);
			}


		if(prod.pjoin==9){
			var oqtlist;
			try{
				oqtlist = currentqty(idx);
			}catch(e){console.log(e);}

			html_cmmn = '<div class="col-12">';
			html_cmmn += '<div class="row mb-2">';
			html_cmmn += '<label class="col-form-label col-2">수량</label>';
			html_cmmn += '<div class="col-auto">';
			html_cmmn += '<select id="'+sIdx+'hd_'+cover.covercd+'0_ordqty" class="form-select" onchange="chgopt(this);">';
			for(var qkey in oqtlist){
				if(idx>0&&qkey==0){
					html_cmmn += '<option value>선택하세요</option>'; //부자재는 기본 선택사항
				}
				html_cmmn += '<option value='+oqtlist[qkey]+'>'+oqtlist[qkey]+'</option>';
			}
			html_cmmn += '</select> ';

			//#===================> ordcnt
			html_cmmn += '<input type="hidden" id="'+sIdx+'hd_00_ordcnt" value="1" />';
			//#<================== end of ordcnt
			html_cmmn += '</div>';
			html_cmmn += '<label class="col-form-label col-auto">'+prod.unit+'</label>';
			html_cmmn += '</div>';
			html_cmmn += '</div>';
			$(tcvcd).append(html_cmmn);
		}
		//#<======================================= end of ordqty


		//#=======================================> awk
		console.log("후가공!!");
		var req_awks = new Array(); //필수후가공
		var req_awksyn = '';
		var awks;
		try{
			awks = null;
			awks = prod.awkjobinfo.filter(awkj=>{return awkj.covercd==cover.covercd});
			req_awksyn = awks[0].type; //후가공 필수(최소1개-radio, 없어도되는 것 select );
		}catch(e){console.log('후가공없음 표시 생략...!!');console.log(e); awks=null;}
		//console.log(awks);
		if(!isEmpty(awks)){
			html_cmmn = '<div class="row">';
			html_cmmn += '<div class="py-1">후가공'
			if(req_awksyn=='radio'){
				html_cmmn += ' <span class="text-danger">(최소 1가지 이상)</span>';
			}
			html_cmmn += '</div>';
			for(var akey in awks){
				console.log("akey : " + akey);
				console.log("coverCd check : " + awks[akey].covercd + " : " + cover.covercd);
				//if(awks[akey].covercd==cover.covercd){
				var jobglist = awks[akey].jobgrouplist;
				for(var gkey in jobglist){
					console.log("gkey : " + gkey);
					var job = jobglist[gkey];
					var awkjob = jobglist[gkey].awkjoblist;
					//html_cmmn +='<div id="awk'+gkey+'">';
					var awkjobid = sIdx+'hd_'+cover.covercd+'0_awk_'+gkey;
					var req = '';
					console.log('=========>job');
					console.log(job);
					console.log(job);
					if(job.type=='radio'){ //req awk
						req_awks.push(awkjobid);
						req = ' <span class="text-danger">(필수)</span>';
					}

					html_cmmn += '<div id="'+sIdx+'awk_'+cover.covercd+'0_'+gkey+'">';
					html_cmmn += '<div class="row mb-2">';
					html_cmmn += '<label class="col-form-label col-2">'+job.jobgroup+req+'</label>';
					var jobs = job.joblist;
					html_cmmn += '<div class="col-auto">';
					html_cmmn += '<select class="form-select" id="'+awkjobid+'" onchange="chgopt(this);">';
					html_cmmn += '<option value>선택하세요</option>';
					for(var jkey in awkjob){
						html_cmmn += '<option value='+awkjob[jkey].jobno+'>'+awkjob[jkey].jobname+'</option>';
					}
					html_cmmn += '</select></div>';
					html_cmmn +='</div>';
					html_cmmn +='</div>';

				}
				//break;
				//}
			}
			html_cmmn +='</div>';
			$(tcvcd).append(html_cmmn);

			console.log('req_awks...필수 후가공 표출');
			console.log(prod);
			console.log(req_awks);
			for(var kid in req_awks){
				$('#'+req_awks[kid]+ ' option:eq(1)').prop('selected', true);
				$('#'+req_awks[kid]).trigger('change');
			}
		}
		//#<======================================= end of awk

	} // coverpage


	btnOrd(prod.idx,'calc')
}

/*용지, covercd */
function paper(prod, covercd, paperno){
	return prod.paperinfo.find(paper=>{return paper.covercd==covercd}).paperlist.find(pp=>{return pp.paperno==paperno});
}

/*용지, covercd [paperlist] */
// 2025/06/23 조재만 수정 // NCR 관련으로 분기 추가
//function paperlist(prod, covercd){
function paperlist(prod, covercd){
	if(prod.pjoin==0||prod.pjoin==9){// papaerno of qty
		console.log('pplist...!!');
		//console.log(prod.paperinfo.find(paper=>{return paper.covercd==covercd}).paperlist);
		console.log('>>> paperlist 호출:', {
			prodno: prod.prodno,
			covercd,
			paperinfo: prod.paperinfo
		});
		return prod.paperinfo.find(paper=>{return paper.covercd==covercd}).paperlist.filter(pp=> {return checkqtyp(prod,covercd,pp.paperno)} );
	}else{
		return prod.paperinfo.find(paper=>{return paper.covercd==covercd}).paperlist;
	}
}

// 2025/06 조재만 추가 // NCR지 콤보박스 반영 시 다른 종이 데이터 충돌로 논리 오류가 나지 않도록 따로 추가.
function paperlistNcr(prod, partId) {
	const paperInfo = prod.paperinfo?.[0];
	if (!paperInfo?.ncr) return [];

	const ncr = paperInfo.ncr;
	let rawList = [];

	if (partId === 'top')		rawList = ncr.paper1list;
	else if (partId === 'middle1') rawList = ncr.paper2list;
	else if (partId === 'middle2') rawList = ncr.paper3list;
	else if (partId === 'bottom')  rawList = ncr.paper4list;

	if (Array.isArray(rawList)) {
		return rawList.map(p => ({
			paperno: p.PaperNo,
			paperName: p.PaperName,
		}));
		return [];
	}
}

/*후가공, covercd, awkidx joboption */
function joboption(prod,covercd, awkidx,jobno){
	return prod.awkjobinfo.find(awk=>{return awk.covercd==covercd}).jobgrouplist[awkidx].awkjoblist.find(job=>{return job.jobno==jobno}).req_joboption;
}

/* size & color + paper  => qty? */
function checkqtyp(prod, covercd, paperno){
	console.log('#checkqtyp');
	var idx = prods.indexOf(prod);
	var sIdx = 'p'+idx+'_';
	var tIdx = '#p'+idx+'_';
	var sizeno = $(tIdx+'hd_00_szno').val();
	var colorno = $(tIdx+'hd_00_clrno').val();
	var colorno_add = $(tIdx+'hd_00_clrno_add').val(); //추가도수
	colorno_add = isEmpty(colorno_add)?null:colorno_add; //추가도수
	console.log('단가목록확인');
	console.log(sizeno,colorno,paperno, colorno_add);
	var qtylist = prod.ordqty;
	var list =  qtylist.filter(
			ordqty=>{ return (
					(ordqty.sizeno==sizeno||ordqty.sizeno==null)
					&&(ordqty.paperno==paperno||ordqty.paperno==null)
					&&(ordqty.colorno==colorno||ordqty.colorno==null)
					&&(ordqty.colornoadd==colorno_add||ordqty.colornoadd==null)
			)}
	);

	console.log(list);
	return !isEmpty(list);
}
/* qty */
function currentqty(idx){
	var sIdx = 'p'+idx+'_';
	var tIdx = '#p'+idx+'_';
	var prod = prods[idx];
	var sizeno = $(tIdx+'hd_00_szno').val();
	var paperno = $(tIdx+'hd_00_pgno').val();
	var colorno = $(tIdx+'hd_00_clrno').val();
	var colorno_add = $(tIdx+'hd_00_clrno_add').val();
	colorno_add = isEmpty(colorno_add)?null:colorno_add; //추가도수

	console.log('currentqty....!!!!');
	console.log(sizeno, paperno, colorno, colorno_add);

	var qtylist = prod.ordqty;
	//console.log(qtylist);
	var qtylist =  qtylist.find(
		ordqty=>{ return (
					(ordqty.sizeno==sizeno||ordqty.sizeno==null)
					&&(ordqty.paperno==paperno||ordqty.paperno==null)
					&&(ordqty.colorno==colorno||ordqty.colorno==null)
					&&(ordqty.colornoadd==colorno_add||ordqty.colornoadd==null)
				)}
	).ordqtylist;

	return qtylist;
}

/* 옵션변경에 따른 분기  *
 * restrict or require or display options*/
function chgopt(obj){
	var isChangingOpt = false;

	console.log('chgopt....!!');
	console.log(obj.id);
	var pinfo = obj.id.split('_');
	var idx = pinfo[0].substr(1);
	var sIdx = pinfo[0]+'_';
	var tIdx = '#'+pinfo[0]+'_';
	var covercd = pinfo[2].substr(0,1);
	var pagecd = pinfo[2].substr(1,1);
	var prod = prods[idx];

	//제품단가결과 초기화
	initDisp(tIdx);

	var reqty = true; //수량변경 갱신용
	if((obj.id).indexOf('clrno')>-1){ 		//clrno
		reqty = chgclrno(obj);

		//reset paper (도수변경에 따른 용지 초기화 필요.)<==용지 변경되면 안되는 경우 예외처리 필요
		resetpaper(obj);

	}else if((obj.id).indexOf('awk')>-1){ 	//awk
		if((obj.id).startsWith(sIdx+'awk')){		//awkopt
			chgawkopt(obj);
		}else{
			chgawk(obj);
		}
		reqty = false; 	//후가공 변경은 수량 목록 갱신 필요없음

	}else if((obj.id).indexOf('pgno')>-1){ 	//paper
		reqty = chgpgno(obj);

	}else if((obj.id).indexOf('szno')>-1){ 	//size
		console.log('szno...');
		if((obj.id).indexOf('x')>-1||(obj.id).indexOf('y')>-1){
			reqty = chgsznoxy(obj);
		}else{ // set cut size
			reqty = chgszno(obj);
			//console.log('chg... chaged.. refresh qty..:'+reqty);
		}

		//reset color
		resetcolor(obj);
		//reset paper
		resetpaper(obj);


		if(reqty&&!checkqtys(obj)){ //no qty? reset color
			console.log('sz chage...  no color option change ');
		}else{
			console.log('sz chage... color option reset.. ');
		}
	}else if(obj.id.endsWith('_optno') && prod.paperinfo[0].paperlist.some(function(p){ return p.papergroup === 'NCR'; })) {
		var optno = parseInt(obj.value, 10);

		// NCR 옵션 중복 반영 방지용 플래그 (선택사항, 필요 시 상단에 let isChangingOpt 선언)
		if (isChangingOpt) return;
		isChangingOpt = true;

		for (var i = 0; i < prod.colorinfo.length; i++) {
			var ci = prod.colorinfo[i];
			var pagelist = ci.pagelist || [];

			for (var j = 0; j < pagelist.length; j++) {
				var pg = pagelist[j];
				var selectId = sIdx + 'hd_' + covercd + pg.pagecd + '_clrno';
				var $clr = $('#' + selectId);
				if ($clr.length == 0) continue;

				var colorlist = pg.colorlist || [];
				var html = '';
				for (var k = 0; k < colorlist.length; k++) {
					var c = colorlist[k];

					// ❗ rst_opt는 제외 조건 → optno가 포함되어 있으면 제외해야 함
					if (!Array.isArray(c.rst_opt) || !c.rst_opt.some(function(o) { return o.optno === optno; })) {
						console.log("== colorlist ==", colorlist);
						html += '<option value="' + c.colorno + '">' + c.colorname + '</option>';
					}
				}
				$clr.html(html);
			}
		}

		// 중복 반영 방지용 플래그 해제
		isChangingOpt = false;

	}else{
		//reqty false
		if((obj.id).indexOf('hd_00_ordqty')>-1||(obj.id).indexOf('hd_00_ordcnt')>-1){ // 수량변경은 목록 갱신할 필요 없음
			reqty = false;
			if(prod.pjoin==0){

			}
		}

	}

	if(reqty){//수량 목록 갱신(size, color, paper 변경 시 목록 변경 필요.)
		console.log('refresh qty list')
		refreshqty(idx);
	}else{
		//fail to calc , init param...?
	}

	console.log('end of chgopt');

	btnOrd(idx, 'calc');
}

function initDisp(tIdx){
	//status
	$(tIdx+"od_00_timestamp").html('');
	$(tIdx+"od_00_status").html('');
	$(tIdx+"od_00_msg").html('');
	//인쇄비
	$(tIdx+"od_00_prscost").html('0');
	//후가공비
	$(tIdx+"od_00_awkcost").html('0');
	//할인
	$(tIdx+"od_00_dccost").html('0');
	//공급가 = 원가-할인+부가세
	$(tIdx+"od_00_supcost").html('0');
	//부가세
	$(tIdx+"od_00_taxcost").html('0');
	//청구가
	$(tIdx+"od_00_bill").html('0');
	output($(tIdx+'prettyResultCalc'), syntaxHighlight(null));
}

/**후가공 변경 시 */
function chgawk(obj){
	console.log('chgawk====> ');
	console.log(obj);
	//console.log(obj.id);
	//var prod = tdata.prod_info.rslt;
	var pinfo = obj.id.split('_');
	var idx = pinfo[0].substr(1);
	var covercd = pinfo[2].substr(0,1);
	//var awkidx = pinfo[2].substr(3);
	var awkidx = pinfo[4];
	//var awkidx = pinfo[2];
	//console.log(obj);
	//console.log(obj.className);
	var sIdx = 'p'+idx+'_';
	var tIdx = '#p'+idx+'_';
	var optclass = sIdx+'awk_'+covercd+'0_'+awkidx+'_opt';
	var optid = sIdx+'awk_'+covercd+'0_'+awkidx+'_opt';
	$('.'+optclass).remove();// init awk option

	console.log('covercd:'+covercd,'awkidx:'+awkidx);

	prod = prods[idx];
	var awks = prod.awkjobinfo;
	if(isEmpty(awks))return;
	var jlist= awks.find(awk=>{return awk.covercd==covercd}).jobgrouplist[awkidx].awkjoblist;
	//var jlist = awks[0].jobgrouplist;
	console.log("new awks: " + awks);
	console.log(awks);
	console.log("new : " + jlist);
	console.log(jlist);
	//var jgrp = jlist;
	var jgrp = jlist.find(j=>{return j.jobno==obj.value});
	//console.log(jgrp);
	//사이즈 & 후가공 제약조건
	var curszno = $(tIdx+'hd_00_szno').val();
	var sz_x = parseFloat(nvl($(tIdx+'hd_00_szno_x').val(),'0'));
	var sz_y = parseFloat(nvl($(tIdx+'hd_00_szno_y').val(),'0'));
	var szinfo = prods[idx].sizeinfo[0].sizelist.filter(szobj=>{return szobj.sizeno==curszno})[0];
	var req_awkjob = szinfo.req_awkjob;
	if(!isEmpty(req_awkjob)){
		var awkjob = getparams(idx).awkjob;		//선택된 후가공목록
		var awkgrp = req_awkjob.jobgrouplist;   //현재사이즈 필수후가공목록
		if((sz_x+sz_y)>=req_awkjob.min_sum_wh&&(isEmpty(awkjob)||!isBelongTo(awkjob,awkgrp))){
			alert(req_awkjob.unit+'이 '+req_awkjob.min_sum_wh+'이상이면 '+awkgrp[0].jobgroup+' 후가공이 필수입니다.');
			return;
		}
	}


	if(!isEmpty(jgrp)){
		var isBreak = false;
		if(!isEmpty(jgrp.rst_jobqty)){	//매수 제약사항
			console.log(jgrp.rst_jobqty);
			var jobqty = $(tIdx+'hd_00_ordqty').val();
			if(!isEmpty(jgrp.rst_jobqty.min)&&jobqty<jgrp.rst_jobqty.min){
				alert('최소 수량 '+jgrp.rst_jobqty.min + ' 부터 가능');
				isBreak = true;
			}else if(!isEmpty(jgrp.rst_jobqty.max)&&jobqty>jgrp.rst_jobqty.max){
				alert('최대 수량'+jgrp.rst_jobqty.max + ' 까지 가능');
				isBreak = true;
			}
		}
			console.log('size 제약사항1');
			console.log(jgrp);
		if(!isEmpty(jgrp.rst_size)){	//size 제약사항

			console.log('size 제약사항');
			console.log(jgrp.rst_size);
			var width = $(tIdx+'hd_00_szno_x').val();
			width = Number(width);
			var height = $(tIdx+'hd_00_szno_y').val();
			height = Number(height);

			if(!isEmpty(jgrp.rst_size.min_width)&&width<jgrp.rst_size.min_width){
				alert('가로는 최소'+jgrp.rst_size.min_width + ' 부터 가능');
				isBreak = true;
			}else if(!isEmpty(jgrp.rst_size.max_width)&&width>jgrp.rst_size.max_width){
				alert('가로는 최대'+jgrp.rst_size.max_width + ' 까지 가능');
				isBreak = true;
			}else if(!isEmpty(jgrp.rst_size.min_height)&&height<jgrp.rst_size.min_height){
				alert('세로는 최소'+jgrp.rst_size.min_height + ' 부터 가능');
				isBreak = true;
			}else if(!isEmpty(jgrp.rst_size.max_height)&&height>jgrp.rst_size.max_height){
				alert('세로는 최대'+jgrp.rst_size.max_height + ' 까지 가능');
				isBreak = true;
			}

		}

		console.log('=======================!!!');
		if(!isEmpty(jgrp.rst_paper)&&!isBreak){// paper 제약사항
			var curppno = $(tIdx+'hd_00_pgno').val();
			var rstpaper = jgrp.rst_paper.find(rstpp=>{return rstpp.paperno==curppno});
			if(!isEmpty(rstpaper)){
				console.log('=======================');
				console.log(rstpaper);
				alert(rstpaper.papername + ' 에서는 '+ jgrp.jobname +'작업이 불가능 합니다. ');
				isBreak = true;
			}
		}



		if(isBreak){ // 이전 값으로 되돌리기?(작업필요)
			return;
		}

		//UI 작업
		if(!isEmpty(jgrp.req_joboption)){
			var joboption = jgrp.req_joboption;
			if(joboption.type=='select'){
				var list = joboption.optionlist;
				var html_cmmn='';
				html_cmmn+='<div class="col-auto py-1 '+optclass+'">';
				html_cmmn+='<span class="m-3 '+optclass+'">옵션선택:</span>';
				//html_cmmn+='<select id="'+pinfo[2]+'" class="'+optclass+'" onchange="chgopt(this);" >';
				html_cmmn+='<select id="'+optid+'_'+jgrp.jobno+'" class="'+optclass+'" onchange="chgopt(this);" >';
				for(var lkey in list){
					html_cmmn+='<option value="'+list[lkey]+'">'+list[lkey]+'</option>';
				}
				html_cmmn+='</select>';
				html_cmmn+='</div>';
				//html_cmmn+='</div>';
				//$('#'+pinfo[2]).append(html_cmmn);
				//$('#awk_'+covercd+'0_'+awkidx).append(html_cmmn);
				$(tIdx+'awk_'+covercd+'0_'+awkidx).children('div').first().append(html_cmmn);
			}else if(joboption.type=='radio'){
				console.log('awk opt radio');
			}else if(joboption.type=='checkbox'){
				var html_cmmn='';
				var list = joboption.optionlist;
				html_cmmn+='<div class="col-auto py-1 '+optclass+'">';
				for(var lkey in list){
					html_cmmn += '<label for="'+optid+'_'+jgrp.jobno+'_'+lkey+'" class="'+optclass+'">'+list[lkey]+'</label>';
					html_cmmn += '<input type="checkbox" id="'+optid+'_'+jgrp.jobno+'_'+lkey+'" name="'+optid+'" class="'+optclass+'" value="'+list[lkey]+'" onchange="chgopt(this);" />';
				}
				html_cmmn+='</div>';
				//$('#'+pinfo[2]).append(html_cmmn);
				$(tIdx+'awk_'+covercd+'0_'+awkidx).children('div').first().append(html_cmmn);
			}
		}
	}


}

/*선택된 후가공 a가  필수후가공 목록 b에 있는 지*/
function isBelongTo(a, b){
	console.log('isBelongTo...');
	for(var i in a){
		var bb = (b[0].joblist).find(ba => {return ba.jobno==a[i].jobno});

		if(!isEmpty(bb)){
			console.log(bb);
			console.log('isBelongTo..true.');
			return true;
		}
	}
	console.log('isBelongTo..fas.');
	return false;
}


function btnOrd(idx, reqtype){

	//부자재가 모두 로드되면, 단가요청 1회
	if(isEmpty(prods[0].prodaddinfo)){
		console.log('calc start1...!');
	}else if(prods[0].prodaddinfo.length+1==prods.length){
		console.log('calc start2...!');
	}else{
		console.log('전제품 로드전에 단가 요청은 무시...!!!');
		//return;
	}


	console.log('##btnOrd...!:'+idx+' reqtype:'+reqtype);
	if(reqtype=='calc'){
		if(idx=='all'){//all prod
			for(var ix in prods){
				var sIdx = 'p'+ix+'_';
				var tIdx = '#p'+ix+'_';
				$(tIdx+'prettyResult').text(''); //초기화
				var options ={};
				options.idx = ix;
				options.type = 'post';
				options.form_data = getparams(ix);	//form_data;
				options.url = '/std/prod/jobcost';
				options.callbackfunc = setuprst; 	//result_ord_request; //callback
				console.log('-------------price/options------------');
				console.log(options);
				getOrdParams();	//주문옵션 파라미터 표출
				try{output($(tIdx+'prettyResult'), syntaxHighlight(options.form_data))}catch(e){$(tIdx+'prettyResult').text(e);};	//
				if(ix>0&&(isEmpty(options.form_data.prsjob[0])||isEmpty(options.form_data.prsjob[0].jobqty))){ //부자재 단가 빼기-수량선택 안됨
					console.log('부자재...선택안됨');
					//인쇄비
					$(tIdx+"od_00_prscost").html(0);
					//부자재비
					$(tIdx+"od_00_addcost").html(0);
					//후가공비
					$(tIdx+"od_00_awkcost").html(0);
					//할인
					$(tIdx+"od_00_dccost").html(0);
					//공급가 = 원가-할인+부가세
					$(tIdx+"od_00_supcost").html(0);
					//부가세
					$(tIdx+"od_00_taxcost").html(0);
					//청구가
					$(tIdx+"od_00_bill").html(0);

					sumcost(); //재계산
					$(tIdx+'prettyResultCalc').text('선택하세요.'); //초기화
				}else{
					httpclient(options);

				}
			}
		}else{// one of all prods
			var tIdx = '#p'+idx+'_';
			$(tIdx+'prettyResult').text(''); //초기화
			var options ={};
			options.idx = idx;
			options.type = 'post';
			options.form_data = getparams(idx);	//form_data;
			options.url = '/std/prod/jobcost';
			options.callbackfunc = setuprst; 	//result_ord_request; //callback
			console.log('-------------price/options------------');
			console.log(options);
			getOrdParams();	//주문옵션 파라미터 표출
			try{output($(tIdx+'prettyResult'), syntaxHighlight(options.form_data))}catch(e){$(tIdx+'prettyResult').text(e);};	//

			if(idx>0&&(isEmpty(options.form_data.prsjob[0])||isEmpty(options.form_data.prsjob[0].jobqty))){ //부자재 단가 빼기-수량선택 안됨
				console.log('부자재...선택안됨');
				//인쇄비
				$(tIdx+"od_00_prscost").html(0);
				//부자재비
				$(tIdx+"od_00_addcost").html(0);
				//후가공비
				$(tIdx+"od_00_awkcost").html(0);
				//할인
				$(tIdx+"od_00_dccost").html(0);
				//공급가 = 원가-할인+부가세
				$(tIdx+"od_00_supcost").html(0);
				//부가세
				$(tIdx+"od_00_taxcost").html(0);
				//청구가
				$(tIdx+"od_00_bill").html(0);

				sumcost(); //재계산
				$(tIdx+'prettyResultCalc').text('선택하세요.'); //초기화
			}else{
				httpclient(options);

			}
		}
	}else if(reqtype=='ord'){
		if(isEmpty($('#to_zip').val())){
			alert('받으실 분 우편번호를 입력하세요.');
			return;
		}
		//all 주문
		var options ={};
		options.type = 'post';
		options.form_data = getOrdParams();	//주문 파라미터(모든 제품)
		options.url = '/std/prod/order';
		options.callbackfunc = setupordrst; //result_ord_request; //callback
		console.log('-------------order options------------');
		console.log(options);
		console.log('-------------order options------------');
		httpclient(options);
	}else{
		console.log('reqtype is ....?'+reqtype);
	}
}


function setDlvyInfo(prod){
	//dlvy mcd
	var optlist= prod.deliverinfo.dlvymcdlist;
	for(var idx in optlist){
		console.log(optlist[idx]);
		$('select[id="dlvymcd"]').append('<option value="'+optlist[idx].dlvymcd+'" '+(optlist[idx].dlvymcd==4?'selected':'')+'>'+optlist[idx].dlvyname+'</option>');
	}
}


function getparams(idx){
	console.log('##get params...');
	//var prod = tdata.prod_info.rslt;
	//var idx = prods.indexOf(prod);
	var sIdx = 'p'+idx+'_';
	var tIdx = '#p'+idx+'_';
	var prod = prods[idx];

	var form_data={};
	//# ord info:#1  basic info  ----
	/* if(!isEmpty(reqtype)){
		form_data.act	= reqtype;
	} */
	//form_data.pjoin = prod.pjoin;
	form_data.prodno = prod.prodno;
	form_data.ordqty = $(tIdx+'hd_00_ordqty').val();
	form_data.ordcnt = $(tIdx+'hd_00_ordcnt').val();
	var ordtitle=$('#ordtitle').val();
	var ordbody=$('#ordmemo').val();
	form_data.ordtitle=isEmpty(ordtitle)?'API-주문입니다.':ordtitle;
	form_data.ordbody=isEmpty(ordbody)?'memo for order':ordbody;
	if($("#ckaddcost").is(':checked')){
		form_data.ckaddcost = 'Y';
	}
	var ordkey=$('#ordkey').val();
	form_data.ordkey=isEmpty(ordkey)?('seq_000000000000000000000000'+Math.floor((Math.random() * 100))):ordkey;
	//-----------------------------

	var djobs = new Array();		//# ord info:#2 - prs (job)
	var dawks = new Array();		//# ord info:#3 - awk
	var coverinfo = prod.coverinfo;
	for(var ckey in coverinfo){			//ckey is index 0,1,2,3
		var cover = coverinfo[ckey];
		//jpno: jobpresetno
		if(ckey==0){
			var jpno = $(tIdx+'hd_'+cover.covercd+'0_prs').val();
			form_data.jobpresetno = isEmpty(jpno)?null:jpno;
		}
		//prs
		//if(!isEmpty($(tIdx+'hd_'+cover.covercd+'0_prs').val())||prod.pjoin==9){
			var job = {};
			job.jobno = $(tIdx+'hd_'+cover.covercd+'0_prs').val();
			job.covercd = cover.covercd;
			job.sizeno = $(tIdx+'hd_00_szno').val();
			job.wsize = $(tIdx+'hd_00_szno_x').val();
			job.hsize = $(tIdx+'hd_00_szno_y').val();
			//job.ordqty ='';		//독판?
			job.jobqty = $(tIdx+'hd_00_ordqty').val();		//hd_00_ordqty 합판 , 독판은 covercd

			// 2025/06/27 조재만 추가 // ncr일 땐 pagecnt 없음.

			//job.pagecnt = $(tIdx+'hd_'+cover.covercd+'0_pagecnt').val();

			if (prod.paperinfo && prod.paperinfo.length > 0 && prod.paperinfo[0].ncr) {
				// NCR인 경우
				job.pagecnt = 0;
			} else {
				// 일반 제품
				job.pagecnt = $(tIdx + 'hd_' + cover.covercd + '0_pagecnt').val();
			}


		//job.pressm = '';		//독판?
			//job.qunit = '';
			job.paperno = $(tIdx+'hd_'+cover.covercd+'0_pgno').val();
			job.optno = $(tIdx+'hd_'+cover.covercd+'0_optno').val();
			//job.colorno = $('#hd_'+cover.covercd+'0_clrno').val();
			//job.colorno0 = $(tIdx+'hd_'+cover.covercd+'0_clrno').val();
			//job.colorno0Add = $(tIdx+'hd_'+cover.covercd+'0_clrno_add').val();
			//전후면
			//var pages = pagelist(cover.covercd);
			//var pages = prod.colorinfo.find(cvpg =>{return cvpg.covercd==cover.covercd}).pagelist;

			var pages = isEmpty(prod.colorinfo)?null:prod.colorinfo.find(cvpg =>{return cvpg.covercd==cover.covercd}).pagelist;
			for (var i in pages) {
				var add = $(tIdx + 'hd_' + cover.covercd + pages[i].pagecd + '_clrno_add').val();
				job['colorno' + pages[i].pagecd] = $(tIdx + 'hd_' + cover.covercd + pages[i].pagecd + '_clrno').val();
				job['colorno' + pages[i].pagecd + 'add'] = isEmpty(add) ? '' : add;
			}

		// NCR지 예외 처리 (joboptmsg 추가) 2025/06/ 조재만 추가
		if (prod.paperinfo?.[0]?.ncr) {
			const parts = [];

			['middle1', 'middle2', 'bottom'].forEach(partId => {
				const sel = $('#' + sIdx + 'ncr_' + partId);
				if (sel.length > 0) {
					const val = sel.val();
					const label = sel.closest('div.row').find('label').text().trim();
					if (val) parts.push(label + ':' + val);
				}
			});


			const optmsgForCompare = parts.join('|');  // 비교용

			const joboptlist = prod.paperinfo[0].ncr.req_joboptmsg || [];

			if (joboptlist.includes(optmsgForCompare)) {
				job.joboptmsg = optmsgForCompare;  // API 전송 시 포함
				console.log(">> optmsgForSave 확인 ===");
			} else {
				console.warn("NCR 용지 조합 불일치");
				console.warn("입력값:", optmsgForCompare);
				console.warn("가능한 조합:", joboptlist);
				//return null;
			}
		}

		// 2025/06/23 조재만 추가 / NCR도 되도록.
		//if (!isEmpty(pages) && !isEmpty(job['colorno' + pages[0].pagecd])) {
		if ((!isEmpty(pages) && !isEmpty(job['colorno' + pages[0].pagecd])) || (prod.paperinfo?.[0]?.ncr)  // NCR인 경우도 허용
		) {
			djobs.push(job);
		} else if (job.jobno == '30') {
			djobs.push(job);
		}

		//}

		//awk
		var awks = prod.awkjobinfo;
		if(!isEmpty(awks)){
			for(var akey in awks){
				if(awks[akey].covercd==cover.covercd){
					var jobglist = awks[akey].jobgrouplist;
					for(var gkey in jobglist){
						var job = jobglist[gkey];
						var jobno = $(tIdx+'hd_'+cover.covercd+'0_awk_'+gkey).val();
						if(!isEmpty(jobno)){//  selected awk
							//console.log("========job=======");
							//console.log(job);
							//var ak = job.joblist.filter(jb=>{return jb.jobno==jobno})[0];
							var ak = job.awkjoblist.find(jb=>{return jb.jobno==jobno});
							var awk = {};
							awk.jobno = jobno;
							awk.covercd = cover.covercd;
							awk.pagecd = '0';
							awk.sizeno = $(tIdx+'hd_00_szno').val();
							awk.wsize = $(tIdx+'hd_00_szno_x').val();
							awk.hsize = $(tIdx+'hd_00_szno_y').val();
							awk.jobqty = $(tIdx+'hd_00_ordqty').val();		//hd_00_ordqty 합판 , 독판은 covercd
							//joboptmsg
							//var joboptmsg='';
							var joboptmsg= new Array();
							if(!isEmpty(ak.req_joboption)){
								if(ak.req_joboption.type=='select'){
									//console.log('#awk'+gkey+'opt');
									//joboptmsg = $('#awk'+gkey+'opt').val();
									console.log(tIdx+'awk_'+cover.covercd+'0_'+gkey+'_opt'+jobno);
									//joboptmsg = $(tIdx+'awk_'+cover.covercd+'0_'+gkey+'_opt_'+jobno).val();
									joboptmsg.push($(tIdx+'awk_'+cover.covercd+'0_'+gkey+'_opt_'+jobno).val());
								}else if(ak.req_joboption.type=='checkbox'){
									var opts = $('input:checkbox[name="'+sIdx+'awk_'+cover.covercd+'0_'+gkey+'_opt"]');
									for(var i=0; i< opts.length;i++){
										if(opts[i].checked==true){
											//joboptmsg += ((isEmpty(joboptmsg)?'':',')+opts[i].value);
											joboptmsg.push(opts[i].value);
										}
									}
								}
							}
							awk.joboptmsg = isEmpty(joboptmsg)?null:joboptmsg;
							//add awk
							dawks.push(awk);
						}
					}
					break;
				}
			}
		}
	}

	form_data.prsjob = djobs;
	form_data.awkjob = dawks;
	console.log(">> 최종 form_data =", JSON.stringify(form_data, null, 2));
	return form_data;
}


//calc 결과  가격표시
function setuprst(data){
	console.log('##조회결과 가격표시 setuprst...!!!');
	console.log(data);
	console.log(data.cjson_jobcost);
	if(!isEmpty(data.cjson_jobcost)){
		var cjson_jobcost = data.cjson_jobcost;
		var idx = data.idx;
		var sIdx = 'p'+idx+'_';
		var tIdx = '#p'+idx+'_';

		try{
			var ordcost_base = cjson_jobcost.ordcost_base;
			//status
			$(tIdx+'od_00_timestamp').html(cjson_jobcost.timestamp);
			$(tIdx+'od_00_status').html(cjson_jobcost.status);
			$(tIdx+'od_00_msg').html(cjson_jobcost.errmsg);

			/* console.log("#### 내야할 후가공비: " + cjsonOrder.ordcost_detail.ordcost_price.price_awkjob);
			console.log("#### 내야할 인쇄비: " + cjsonOrder.ordcost_detail.ordcost_price.price_prsjob);
			console.log("#### 내야할 할인: " + cjsonOrder.ordcost_dc);
			console.log("#### 내야할 부가세: " + cjsonOrder.ordcost_tax); */

			if(idx==0){
				//인쇄비
				$(tIdx+"od_00_prscost").html(ordcost_base.base_price.price_prsjob);
				//부자재비
				$(tIdx+"od_00_addcost").html(0);
			}else{
				//인쇄비
				$(tIdx+"od_00_prscost").html(0);
				//부자재비
				$(tIdx+"od_00_addcost").html(ordcost_base.base_price.price_prsjob);

			}

			//후가공비
			$(tIdx+"od_00_awkcost").html(ordcost_base.base_price.price_awkjob);
			//할인
			$(tIdx+"od_00_dccost").html(cjson_jobcost.ordcost_dc);
			//공급가 = 원가-할인+부가세
			$(tIdx+"od_00_supcost").html(cjson_jobcost.ordcost_sup);
			//부가세
			$(tIdx+"od_00_taxcost").html(cjson_jobcost.ordcost_tax);
			//청구가
			$(tIdx+"od_00_bill").html(cjson_jobcost.ordcost_bill);


		}catch(e){
			console.log(e);


		}finally{
			sumcost();
			output($(tIdx+'prettyResultCalc'), syntaxHighlight(cjson_jobcost));
		}

		//output($('#prettyResultCalc'), syntaxHighlight(data.cjson_order));


	}


}

//주문 결과 표시 ord결과
function setupordrst(data){
	console.log('set up ord rst......');
	console.log('##주문결과 배송정보 setup ord rst...!!!');
	console.log(data.cjson_order);
	if(!isEmpty(data.cjson_order)){
		//var cjsonOrder = JSON.parse(data.cjson_order);
		var cjson_order = data.cjson_order;

		try{

			console.log(cjson_order.ordinfo[0]);
			//file upload용
			$('#ordnum').val(cjson_order.ordinfo[0][0].ordnum);
		}catch(e){}
	}

	output($('#prettyResultOrd'), syntaxHighlight(cjson_order));
}

//모든 제품 주문 옵션
function getOrdParams(){
	console.log('### getOrdParams....!!!!');
	var ordparam={};  //주문파라미터
	ordparam.action='ord';

	//주문정보 array
	var ords = new Array();
	var ord = new Array();
	for(var idx in prods){
		var tmp = getparams(idx);
		if(idx>0&&(isEmpty(tmp.prsjob[0])||isEmpty(tmp.prsjob[0].jobqty))){//부자재는 수량선택된 것만
			console.log('부자재 수량선택 없음....');
		}else{
			ord.push(tmp); // 주문 정보 array

		}
	}
	ords.push(ord);
	ordparam.ordreq= ords;

	//배송구분
	ordparam.dlvymcd=$('#dlvymcd').val();
	if($('#dlvyno').val()=='155' ||$('#dlvymcd').val()=='0'){
		ordparam.dlvyno=$('#dlvyno').val();
	}else if($('#dlvymcd').val()==1){
		ordparam.dlvyno=$('#dlvyno').val();
	}

	//보내는 사람
	var objfr = {};
	objfr.name=$('#fr_name').val();
	objfr.tel=$('#fr_t01').val()+'-'+$('#fr_t02').val()+'-'+$('#fr_t03').val();
	objfr.zipcode = $('#fr_zip').val();
	objfr.sd= $('#fr_sd').val();
	objfr.sgg=$('#fr_sgg').val();
	objfr.umd=$('#fr_umd').val();
	objfr.addr1=$('#fr_addr1').val();
	objfr.addr2=$('#fr_addr2').val();
	//받는 사람
	var objto = {};
	objto.name=$('#to_name').val();
	objto.tel=$('#to_t01').val()+'-'+$('#to_t02').val()+'-'+$('#to_t03').val();
	objto.zipcode = $('#to_zip').val();
	objto.sd= $('#to_sd').val();
	objto.sgg=$('#to_sgg').val();
	objto.umd=$('#to_umd').val();
	objto.addr1=$('#to_addr1').val();
	objto.addr2=$('#to_addr2').val();
	objto.dlvymsg=$('#to_dlvymsg').val();


	ordparam.dlvyfr= objfr;
	ordparam.dlvyto= objto;
	try{output($('#prettyOrdParam'), syntaxHighlight(ordparam))}catch(e){$('#prettyOrdParam').text(e);};

	return ordparam;
}


//제품단가[합계]
function sumcost(){
	console.log('==================================================');
	var prscost=0,addcost=0,awkcost=0,dccost=0,supcost=0,taxcost=0,bill=0;
	for(var ix in prods){
		var tIdx='#p'+ix+'_';
		if(ix==0){
			//인쇄비
			prscost+=	Number(nvl($(tIdx+'od_00_prscost').text(),'0'));
		}else{
			//부자재비
			addcost+=	Number(nvl($(tIdx+'od_00_addcost').text(),'0'));
		}
		//후가공비
		awkcost+=	Number(nvl($(tIdx+'od_00_awkcost').text(),'0'));
		//할인
		dccost+=	Number(nvl($(tIdx+'od_00_dccost').text(),'0'));
		//공급가 = 원가-할인+부가세
		supcost+=	Number(nvl($(tIdx+'od_00_supcost').text(),'0'));
		//부가세
		taxcost+=	Number(nvl($(tIdx+'od_00_taxcost').text(),'0'));
		//청구가
		bill+=		Number(nvl($(tIdx+'od_00_bill').text(),'0'));
	}

	//인쇄비
	$('#ps_od_00_prscost').html(prscost);
	//후가공비
	$('#ps_od_00_awkcost').html(awkcost);
	//부자재비
	$('#ps_od_00_addcost').html(addcost);
	//할인
	$('#ps_od_00_dccost').html(dccost);
	//공급가 = 원가-할인+부가세
	$('#ps_od_00_supcost').html(supcost);
	//부가세
	$('#ps_od_00_taxcost').html(taxcost);
	//청구가
	$('#ps_od_00_bill').html(bill);
}



function chgszno(obj){
	console.log('chgszno====> ');
	var oj = objInfo(obj);
	var curszno = $(oj.tIdx+'hd_00_szno').val();
	var szinfo = prods[oj.idx].sizeinfo[0].sizelist.filter(szobj=>{return szobj.sizeno==curszno})[0];
	if(szinfo.non_standard){ //비규격 입력 활성화
		// readonly 삭제
		$(oj.tIdx+"hd_00_szno_x").removeAttr("readonly");
		$(oj.tIdx+"hd_00_szno_y").removeAttr("readonly");
	}else{
		// readonly 설정
		$(oj.tIdx+"hd_00_szno_x").attr("readonly",true);
		$(oj.tIdx+"hd_00_szno_y").attr("readonly",true);
	}
	$(oj.tIdx+'hd_00_szno_x').val(szinfo.width);
	$(oj.tIdx+'hd_00_szno_y').val(szinfo.height);

	//rst awk  40083 떡메모지 풀발이
	return true;



}

function chgsznoxy(obj){
	console.log('start chgszno====> ');
	var oj = objInfo(obj);
	var curszno = $(oj.tIdx+'hd_00_szno').val();
	//var prod = tdata.prod_info.rslt;
	var szinfo = prods[oj.idx].sizeinfo[0].sizelist.filter(szobj=>{return szobj.sizeno==curszno})[0];
	//console.log(szinfo);
	var sz_x = parseFloat(nvl($(oj.tIdx+'hd_00_szno_x').val(),'0'));
	var sz_y = parseFloat(nvl($(oj.tIdx+'hd_00_szno_y').val(),'0'));
	var rsth = szinfo.req_height;
	var rstw = szinfo.req_width;

	//----------------------------------------------------
	if(!isEmpty(rstw)){
		console.log('sznoxy...alert.');

		var min = rstw.min;
		var max = rstw.max;
		var itvl = rstw.interval;

		//비규격 inverval
		if(!isEmpty(itvl)&& (sz_x%itvl)>0 ){
			alert(itvl+' 단위입니다.');
			return false;
		}

		if(!isEmpty(min)&&sz_x<min){
			alert(rstw.unit+'는 최소 '+min+'입니다.');
			return false;
		}

		if(!isEmpty(max)&&sz_x>max){
			alert(rstw.unit+'는 최대 '+max+'입니다.');
			return false;
		}
	}

	if(!isEmpty(rsth)){
		var min = rsth.min;
		var max = rsth.max;
		var itvl = rsth.interval;
		//비규격 inverval
		if(!isEmpty(itvl)&& (sz_y%itvl)>0 ){
			alert(itvl+' 단위입니다.');
			return false;
		}

		if(!isEmpty(min)&&sz_y<min){
			alert(rsth.unit+'는 최소 '+min+'입니다.');
			return false;
		}
		if(!isEmpty(max)&&sz_y>max){
			alert(rsth.unit+'는 최대 '+max+'입니다.');
			return false;
		}
	}



	//----------------------------------------------------


	//사이즈 & 후가공
	var req_awkjob = szinfo.req_awkjob;
	if(!isEmpty(req_awkjob)){
		if((sz_x+sz_y)>=req_awkjob.min_sum_wh){
			var awkgrp = req_awkjob.jobgrouplist;
			alert(req_awkjob.unit+'이 '+req_awkjob.min_sum_wh+'이상이면 '+awkgrp[0].jobgroup+' 후가공이 필수입니다.');
		}
	}


	//비규격 & 재질 제약조건
	var curpaperno = $(oj.tIdx+'hd_00_pgno').val();
	//재질조건
	var opaper = paper(prods[oj.idx], oj.covercd, curpaperno)
	var rstpth = opaper.req_height;
	var rstptw = opaper.req_width;

	if(!isEmpty(rstptw)){
		var min = rstptw.min;
		var max = rstptw.max;
		if(!isEmpty(min)&&sz_x<min){
			alert(opaper.papername+'의 '+rstptw.unit+'는 최소 '+min+'입니다.');
			return false;
		}

		if(!isEmpty(max)&&sz_x>max){
			alert(opaper.papername+'의 '+rstptw.unit+'는 최대 '+max+'입니다.');
			return false;
		}

	}

	if(!isEmpty(rstpth)){
		var min = rstpth.min;
		var max = rstpth.max;
		if(!isEmpty(min)&&sz_y<min){
			alert(opaper.papername+'의 '+rstpth.unit+'는 최소 '+min+'입니다.');
			return false;
		}
		if(!isEmpty(max)&&sz_y>max){
			alert(opaper.papername+'의 '+rstpth.unit+'는 최대 '+max+'입니다.');
			return false;
		}

	}




	return true;
	/* //chg cut(x,y)
	if((obj.id).indexOf('_x')){

	}else if((obj.id).indexOf('_y')){

	}else{ //chg sizeno
		console.log('chg sizeno====> ');
	} */
}

//obj에서 정보(idx) 추출
function objInfo(e){
	console.log('objInfo');
	console.log(e);
	var p = e.id.split('_');
	var oj = {};
	oj.idx = p[0].substr(1);
	oj.sIdx = p[0]+'_';			// p0_hd_00_
	oj.tIdx = '#'+p[0]+'_';		// #p0_hd_00_
	oj.covercd = p[2].substr(0,1);
	oj.prod = prods[oj.idx];

	return oj;
}


function resetcolor(obj){
	console.log('===> resetcolor...!');
	console.log(obj);
	//#=======================================> paper
	/* var pinfo = obj.id.split('_');
	var covercd = pinfo[1].substr(0,1); */

	var oj = objInfo(obj);
	var prod = prods[oj.idx];
	var covercd = oj.covercd;

	// 2025/06/24 조재만 추가 / NCR일 때는 변경하지 않음.
	const isNcr = prod.paperinfo?.[0]?.paperlist?.some(p => p.papergroup === 'NCR');
	if (isNcr) {
		return;
	}


	//#=======================================> color (back and forth)
	if(!isEmpty(prod.colorinfo)){
		var colorno;	//init value
		var cvpglist = prod.colorinfo.find(cvpg =>{return cvpg.covercd==covercd}).pagelist;
		for(var pgk in cvpglist ){  //앞, 뒤
			//color
			var clrlist = cvpglist[pgk].colorlist;
			//html_cmmn += '<select id="hd_'+cover.covercd+cvpglist[pgk].pagecd+'_clrno" onchange="chgopt(this);">';
			if(!isEmpty(clrlist)){
				$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno"] option').remove();
				for(var cck in clrlist){
					if(cck==0&&cvpglist[pgk].type=='select')
						$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno"]').append('<option value="">선택하세요</option>');
					$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno"]').append('<option value="'+clrlist[cck].colorno+'">'+clrlist[cck].colorname+'</option>');
				}

				//& coloradd
				var clraddlist = cvpglist[pgk].coloraddlist;
				if(!isEmpty(clraddlist)){
					$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno_add"] option').remove();
					for(var cck in clraddlist){
						if(cck==0)$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno_add"]').append('<option value>도수선택</option>');
						if(cvpglist[pgk].pagecd==1){//전면의 추가도수는 같은색일 수 없음
							if(clraddlist[cck].colornoadd!=colorno)$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno_add"]').append('<option value="'+clraddlist[cck].colornoadd+'">'+clraddlist[cck].colorname+'</option>');
						}else{
							$('select[id="'+oj.sIdx+'hd_'+covercd+cvpglist[pgk].pagecd+'_clrno_add"]').append('<option value="'+clraddlist[cck].colornoadd+'">'+clraddlist[cck].colorname+'</option>');
						}
					}
				}
			}
		}
	}
	//#<======================================= color (back and forth)
}

function resetpaper(obj){
	console.log('===> resetpaper...!');
	console.log(obj);
	//#=======================================> paper
	var pinfo = obj.id.split('_');
	var covercd = pinfo[2].substr(0,1);
	var pagecd = pinfo[2].substr(1,1);

	var oj = objInfo(obj);
	var prod = prods[oj.idx];

	// NCR select가 명확히 존재하면 NCR 전용 처리
	if (prod.paperinfo?.[0]?.ncr) {
		console.log('>> NCR 전용 resetpaper 동작');

		$(`#box_paperlist [data-ncr-part]`).each(function () {
			const $sel = $(this);
			const partId = $sel.data('ncr-part');  // top, middle1, middle2, bottom
			const list = paperlistNcr(prod, partId);

			$sel.empty();
			list.forEach(item => {
				const val = (partId === 'top' && item.paperno) ? item.paperno : item.papername;
				$sel.append(`<option value=""></option>`);
			});
		});

		// NCR일 경우 공용 로직은 실행하지 않고 여기서 return (덮어쓰기 방지)
		return;
	}

	if(!isEmpty(prod.paperinfo)){
		var pplist = paperlist(prod,covercd); //도수에 따라 작업 가능한 종이 목록
		try{
			if(!isEmpty(pplist)){
				$('select[id="'+oj.sIdx+'hd_'+covercd+pagecd+'_pgno"] option').remove();
				for(var idx in pplist){
					$('select[id="'+oj.sIdx+'hd_'+covercd+pagecd+'_pgno"]').append('<option value="'+pplist[idx].paperno+'">'+pplist[idx].papername+'</option>');
				}
			}
		}catch(e){console.log(e);}
	}


	//#<======================================= end of paper
}

/* 후가공 변경 시.*/
function chgawkopt(obj){
	console.log('chgawkopt====> ');
	//console.log(obj);
	//var prod = tdata.prod_info.rslt;
	var pinfo = obj.id.split('_');
	var idx = pinfo[0].substr(1);
	var sIdx = pinfo[0]+'_';
	var tIdx = '#'+pinfo[0]+'_';
	var covercd = pinfo[2].substr(0,1);
	var awkidx = pinfo[3];
	var jobno = pinfo[5];

	var prod = prods[idx];

	//min, max condition
	console.log(prod,covercd, awkidx, jobno);
	var jobopt = joboption(prod,covercd, awkidx, jobno);
	console.log(jobopt);

	if(!isEmpty(jobopt)){
		if(jobopt.type=='checkbox'){
			var ckcnt = 0;
			var opts = $('input:checkbox[name="'+sIdx+'awk_'+covercd+'0_'+awkidx+'_opt"]');
			for(var i=0; i< opts.length;i++){
				if(opts[i].checked==true){
					 ckcnt ++;
				}
			}

			if(!isEmpty(jobopt.max)&&ckcnt>jobopt.max){
				alert('최대 '+jobopt.max+'개 선택가능합니다.');
				return;
			}

			if(!isEmpty(jobopt.min)&&ckcnt<jobopt.min){
				alert('최소 '+jobopt.min+'개 선택해야 합니다.');
				return;
			}
		}
	}

}


/* size & color + paper*/
function checkqtys(obj){
	var oj = objInfo(obj);
	var sizeno = $(oj.tIdx+'hd_00_szno').val();
	var colorno = $(oj.tIdx+'hd_00_clrno').val();
	var colorno_add = $(oj.tIdx+'hd_00_clrno_add').val(); //추가도수
	var prod = prods[oj.idx];
	colorno = isEmpty(colorno_add)?colorno:colorno_add;
	var list = prod.ordqty.filter((ordqty)=>{ return (ordqty.sizeno==sizeno&&ordqty.colorno==colorno)});
	return !isEmpty(list);
}


function refreshqty(idx){
	//var prod = tdata.prod_info.rslt;
	var sIdx = 'p'+idx+'_';
	var tIdx = '#p'+idx+'_';
	var prod = prods[idx];
	if(prod.pjoin==0||prod.pjoin==9){
		var oqtlist;
		try{
			oqtlist = currentqty(idx);
			//console.log(oqtlist);
			if(!isEmpty(oqtlist)){
				$('select[id="'+sIdx+'hd_00_ordqty"] option').remove();
				for(var idx in oqtlist){
					$('select[id="'+sIdx+'hd_00_ordqty"]').append('<option value="'+oqtlist[idx]+'">'+oqtlist[idx]+'</option>');
				}
			}
		}catch(e){console.log(e);}
	}else{// pjoin==1 독판
		var sizeno = $(tIdx+'hd_00_szno').val();
		//case 독판전단
		var initsz = prod.ordqty.find(ordqty =>{return ordqty.sizeno==sizeno});
		//$(tIdx+'hd_00_ordqty').val(initsz.ordqtymin);
		if(!isEmpty(initsz)){
			$(tIdx+'hd_00_ordqty').val(initsz.ordqtymin);
		}
	}
}


function chgclrno(obj){
	console.log('chgclrno====> ');
	//console.log(obj);
	//var prod = tdata.prod_info.rslt;
	var pinfo = obj.id.split('_');
	var idx = pinfo[0].substr(1);
	var sIdx = pinfo[0]+'_';
	var tIdx = '#'+pinfo[0]+'_';
	var covercd = pinfo[2].substr(0,1);
	var pagecd = pinfo[2].substr(1,1);
	var prod = prods[idx];

	if((obj.id).indexOf('add')>-1){//추가도수 변경
		console.log('color_add changed...!!!');
	}else{//도수변경 =>(추가도수 목록 초기화)  => 독판 전단(전후면)
		var clrlist = prod.colorinfo.find(cvpg =>{return cvpg.covercd==covercd}).pagelist.find(pglist =>{return pglist.pagecd==pagecd}).coloraddlist;
		if(!isEmpty(clrlist)){
			console.log('add color init...!!');
			$('select[id="'+obj.id+'_add"]  option').remove();
			$('#'+obj.id+'_add').append('<option value>도수선택</option>');
			for(var idx in clrlist){
				$('#'+obj.id+'_add').append('<option value="'+clrlist[idx].colornoadd+'">'+clrlist[idx].colorname+'</option>');
			}
		}
	}
	return true;
}

/* 재질변경 evnt */
function chgpgno(obj){
	console.log('chgpgno====> ');
	console.log(obj);

	var oj = objInfo(obj);
	var covercd = oj.covercd;
	var curppno= obj.value;
	var opaper = paper(oj.prod, covercd, curppno);

	//후가공제약사항체크 (만약, 여기서 초기화하면 체크 할 필요없음.)
	if(!isEmpty(opaper.rst_awkjob)){
		var rst_awkjob= opaper.rst_awkjob; //용지 제약후가공

		//현재 선택된 후가공 리스트
		var curawk = getparams(oj.idx).awkjob;
		for(var idx in curawk){
			var rst_awk = rst_awkjob.find(awk => {return awk.jobno==curawk[idx].jobno})
			if(!isEmpty(rst_awk)){
				alert(opaper.papername+ '에서는 '+ rst_awk.jobgroup+ '작업 불가능 합니다.');
				break;
			}
		}
	}

	//비규격 & 재질 제약조건
	var sz_x = $(oj.tIdx+'hd_00_szno_x').val();
	var sz_y = $(oj.tIdx+'hd_00_szno_y').val();
	var rstpth = opaper.req_height;
	var rstptw = opaper.req_width;
	if(!isEmpty(rstptw)){
		var min = rstptw.min;
		var max = rstptw.max;
		if(!isEmpty(min)&&sz_x<min){
			alert(opaper.papername+'의 '+rstptw.unit+'는 최소 '+min+'입니다.');
			return false;
		}

		if(!isEmpty(max)&&sz_x>max){
			alert(opaper.papername+'의 '+rstptw.unit+'는 최대 '+max+'입니다.');
			return false;
		}
	}

	if(!isEmpty(rstpth)){
		var min = rstpth.min;
		var max = rstpth.max;
		if(!isEmpty(min)&&sz_y<min){
			alert(opaper.papername+'의 '+rstpth.unit+'는 최소 '+min+'입니다.');
			return false;
		}
		if(!isEmpty(max)&&sz_y>max){
			alert(opaper.papername+'의 '+rstpth.unit+'는 최대 '+max+'입니다.');
			return false;
		}
	}

	return true;
}


/* upload file */
function uploadFile(){
	console.log('##loadProdOpt...!!');

	var file = $("input[name=file]")[0].files[0];
	if (file == null) {
		alert('파일 선택 후 업로드 하세요.');
		return;
	}

	if(isEmpty($('#ordnum').val())){
		alert('주문번호가 없습니다.\n\n주문후 파일을 업로드 해 주세요.');
		return;
	}
	var formData = new FormData();
	formData.append("file", file);
	formData.append("ordnum", $('#ordnum').val());

	//formData.append("target", "api.file");
	//formData.append("FileGrp", "0");//주문파일

	var url = '/std/file/upload';
	//var url = '/std/file/uploadbig';
	console.log(url);

	$.ajax({
		url : url,
		type : "POST",
		processData : false,
		contentType : false,
		data : formData,
		timeout: 6000000,
		success : function(data) {
			console.log(data);
			alert('업로드 되었습니다.');
		},
		error : function(request, status, error) {
			console.log("code:" + request.status + "\n" + "message:"
					+ request.responseText + "\n" + "error:" + error);
		}

	});


}


</script>



<!-- iOS에서는 position:fixed 버그가 있음, 적용하는 사이트에 맞게 position:absolute 등을 이용하여 top,left값 조정 필요 -->
<div id="layer" style="display:none;position:fixed;overflow:hidden;z-index:99999;-webkit-overflow-scrolling:touch;">
<img src="//t1.daumcdn.net/postcode/resource/images/close.png" id="btnCloseLayer" style="cursor:pointer;position:absolute;right:-3px;top:-3px;z-index:99999" onclick="closeDaumPostcode()" alt="닫기 버튼">
</div>

<script>
	/* kakao 주소 */
    // 우편번호 찾기 화면을 넣을 element
    var element_layer = document.getElementById('layer');

    function closeDaumPostcode() {
        // iframe을 넣은 element를 안보이게 한다.
        element_layer.style.display = 'none';
    }

    function setPostCode(ziptype) {//ziptype = frzip/tozip
    	var targetId = (ziptype=='fr')?'fr':'to';
        new daum.Postcode({
            oncomplete: function(data) {
                // 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                // 각 주소의 노출 규칙에 따라 주소를 조합한다.
                // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                var addr = ''; // 주소 변수
                var extraAddr = ''; // 참고항목 변수

                //사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                    addr = data.roadAddress;
                } else { // 사용자가 지번 주소를 선택했을 경우(J)
                    addr = data.jibunAddress;
                }

                // 사용자가 선택한 주소가 도로명 타입일때 참고항목을 조합한다.
                if(data.userSelectedType === 'R'){
                    // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                    // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                    if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                        extraAddr += data.bname;
                    }
                    // 건물명이 있고, 공동주택일 경우 추가한다.
                    if(data.buildingName !== '' && data.apartment === 'Y'){
                        extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }
                    // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                    if(extraAddr !== ''){
                        extraAddr = ' (' + extraAddr + ')';
                    }
                    // 조합된 참고항목을 해당 필드에 넣는다.
                    document.getElementById(targetId+"_addr1").value = extraAddr;

                } else {

                }
                /*시군구 추가*/
                //if(ziptype=='to'){
	                document.getElementById(targetId+"_sd").value = data.sido;
	                document.getElementById(targetId+"_sgg").value = data.sigungu;
	                document.getElementById(targetId+"_umd").value = isEmpty(data.bname1)?data.bname2:data.bname1;
                //}
                /**/

                document.getElementById(targetId+"_addr2").value = '';

                // 우편번호와 주소 정보를 해당 필드에 넣는다.
                document.getElementById(targetId+'_zip').value = data.zonecode;
                document.getElementById(targetId+"_addr1").value = addr;
                // 커서를 상세주소 필드로 이동한다.
                document.getElementById(targetId+"_addr2").focus();

                // iframe을 넣은 element를 안보이게 한다.
                // (autoClose:false 기능을 이용한다면, 아래 코드를 제거해야 화면에서 사라지지 않는다.)
                element_layer.style.display = 'none';

                console.log('data=======================================');
                console.log(data);
                console.log('data=======================================');
              $('.dlvy').change();
            },
            width : '100%',
            height : '100%',
            maxSuggestItems : 5
        }).embed(element_layer);


        // iframe을 넣은 element를 보이게 한다.
        element_layer.style.display = 'block';

        // iframe을 넣은 element의 위치를 화면의 가운데로 이동시킨다.
        initLayerPosition();
    }

    // 브라우저의 크기 변경에 따라 레이어를 가운데로 이동시키고자 하실때에는
    // resize이벤트나, orientationchange이벤트를 이용하여 값이 변경될때마다 아래 함수를 실행 시켜 주시거나,
    // 직접 element_layer의 top,left값을 수정해 주시면 됩니다.
    function initLayerPosition(){
        var width = 300; //우편번호서비스가 들어갈 element의 width
        var height = 400; //우편번호서비스가 들어갈 element의 height
        var borderWidth = 5; //샘플에서 사용하는 border의 두께

        // 위에서 선언한 값들을 실제 element에 넣는다.
        element_layer.style.width = width + 'px';
        element_layer.style.height = height + 'px';
        element_layer.style.border = borderWidth + 'px solid';
        // 실행되는 순간의 화면 너비와 높이 값을 가져와서 중앙에 뜰 수 있도록 위치를 계산한다.
        element_layer.style.left = (((window.innerWidth || document.documentElement.clientWidth) - width)/2 - borderWidth)-200 + 'px';
        element_layer.style.top = (((window.innerHeight || document.documentElement.clientHeight) - height)/2 - borderWidth)-200 + 'px';
        //element_layer.style.z-index = 100;
    }


    function addBasket(){
    	console.log('############Basket');

    	var form_data = getOrdParams();	//주문 파라미터(설정된 모든 제품);
    	var ordinfo='';
    	var ordreq = form_data.ordreq[0];  /* first*/
    	for(var idx in ordreq){
    		console.log('===========>');
    		console.log('idx'+idx);
    		console.log(ordreq[idx]);
    		console.log('===========>'+ordreq[idx].prodno);

    		//ordinfo
    		var objp = prods.find(pd=>{return pd.prodno==ordreq[idx].prodno});
    		console.log(objp);
    		ordinfo += (objp.prodname+'('+ordreq[idx].ordqty+objp.unit+')'+'<br />');

    	}

    	//for display cart list    	바구니 표출 정보
    	form_data.prodno=$('#prodno').text();
    	form_data.prodname=$('#prodname').text();
    	form_data.totalamt=$('#ps_od_00_bill').text();
    	form_data.ordinfo = ordinfo;
		form_data.cartDiv = "CART" // 20225/04/23 추가

    	var options ={};
    	options.type = 'post';
    	options.form_data = form_data;
    	options.url = '/mypage/cart/add';
    	options.callbackfunc = rst_cart_add; //result_cart_add
    	httpclient(options);
    }

	function addSample(){ // 2025/04/23 조재만 추가 // Sample 버튼
    	console.log('############Sample');

    	var form_data = getOrdParams();	//주문 파라미터(설정된 모든 제품);
    	var ordinfo='';
		let ordtext=''; // 2025/05/07 조재만 추가 // 텍스트 요약 저장용

    	var ordreq = form_data.ordreq[0];  /* first*/
    	for(var idx in ordreq){
    		console.log('===========>');
    		console.log('idx'+idx);
    		console.log(ordreq[idx]);
    		console.log('===========>'+ordreq[idx].prodno);

    		//ordinfo
    		var objp = prods.find(pd=>{return pd.prodno==ordreq[idx].prodno});
    		console.log(objp);
			const o = ordreq[idx];
			const job = Array.isArray(o.prsjob) && o.prsjob.length > 0 ? o.prsjob[0] : {};

			let dozParts = [];

			if ('colorno0' in job && job.colorno0 && job.colorno0 !== '-') {
				dozParts.push(findColorName(o.prodno, job.colorno0));
			}
			// if ('colorno0add' in job && job.colorno0add && job.colorno0add !== '-') {
			// 	dozParts.push('도수 추가 ' + findColorName(o.prodno, job.colorno0add));
			// }
			// 전면 도수 묶음
			if (job.colorno1 || job.colorno1add) {
				let front = [];
				if (job.colorno1 && job.colorno1 !== '-') {
					front.push(findColorName(o.prodno, job.colorno1));
				}
				if (job.colorno1add && job.colorno1add !== '-') {
					front.push(findColorName(o.prodno, job.colorno1add));
				}
				if (front.length) {
					dozParts.push('전면(' + front.join(' + ') + ')');
				}
			}

			// 후면 도수 묶음
			if (job.colorno2 || job.colorno2add) {
				let back = [];
				if (job.colorno2 && job.colorno2 !== '-') {
					back.push(findColorName(o.prodno, job.colorno2));
				}
				if (job.colorno2add && job.colorno2add !== '-') {
					back.push(findColorName(o.prodno, job.colorno2add));
				}
				if (back.length) {
					dozParts.push('후면(' + back.join(' + ') + ')');
				}
			}

			let doz = dozParts.length > 0 ? dozParts.join(', ') : '-';

			const qty    = o.ordqty ?? job.jobqty ?? '-';
			const width  = job.wsize ?? '-';
			const height = job.hsize ?? '-';
			//const colorName = findColorName(o.prodno, job.colorno0); // 2025/05/12 도수 한글로 수정
			//const paper  = job.paperno ?? '-';
			const paperName = findPaperName(o.prodno, job.paperno); // 2025/05/08 추가
			const post   = Array.isArray(o.awkjob) && o.awkjob.length > 0
					? '있음'
					: '없음';

    		ordinfo += (objp.prodname+'('+ordreq[idx].ordqty+objp.unit+')'+'<br />');

			console.log("form_data.ordtext:", form_data.ordtext);

			console.log(qty);
			ordtext += '수량:' + qty + '매, ';
			ordtext += '사이즈: ' + width + ' x ' + height + 'mm, ';
			//ordtext += '도수: ' + doz + '도, ';
			//ordtext += '도수: ' + colorName + ', ';
			ordtext += '도수: ' + doz + ', ';
			ordtext += '지질: ' + paperName + ', ';
			ordtext += '후가공: ' + post;
			console.log("ordreq")
			console.log("job :" + job);
		}

		//ordtext += `수량: 100매, 사이즈: 90 x 50mm, 도수: 4도, 용지: 스노우, 후가공: 없음`;
		console.log("ordtext 테스트:", ordtext);
		// ordtext = JSON.stringify(translateKeys(ordreq), null, 2);
		console.log("ordreq : ", JSON.stringify(ordreq, null, 2));
    	//for display sample cart list    	바구니 표출 정보
    	form_data.prodno=$('#prodno').text();
    	form_data.prodname=$('#prodname').text();
    	form_data.totalamt=$('#ps_od_00_bill').text();
    	form_data.ordinfo = ordinfo;
		form_data.cartDiv = "SAMPLE" // 20225/04/23 추가
		form_data.ordtext = ordtext;

		console.log("form_data.ordreq[0] 확인:", form_data.ordreq[0]);
		console.log("ordreq 전체:", JSON.stringify(ordreq, null, 2));
		var options ={};
    	options.type = 'post';
    	options.form_data = form_data;
    	options.url = '/mypage/sample/add';
    	options.callbackfunc = rst_sample_add; //result_sample_add
    	httpclient(options);
    }

	// 2025/05/12 도수 텍스트
	function findColorName(prodno, colorno) {
		const prod = prods.find(p => p.prodno == prodno);
		if (!prod || !prod.colorinfo) return '-';

		for (const colorSet of prod.colorinfo) {
			for (const page of colorSet.pagelist) {
				const match = page.colorlist.find(c => c.colorno == colorno);
				if (match) return match.colorname;
			}
		}
		return '-';
	}

	// const keyMap = {
	// 	"prodno": "제품번호",
	// 	"ordqty": "주문수량",
	// 	"ordcnt": "건수",
	// 	"ordtitle": "주문제목",
	// 	"ordbody": "주문메모",
	// 	"jobpresetno": "작업프리셋번호",
	// 	"ordkey": "주문키",
	// 	"prsjob": "인쇄작업",
	// 	"awkjob": "후가공작업",
	// 	"paperno": "지종코드",
	// 	"hsize": "세로",
	// 	"wsize": "가로",
	// 	"sizeno": "사이즈코드",
	// 	"jobqty": "작업수량",
	// 	"jobno": "작업번호",
	// 	"covercd": "표지코드",
	// 	"colorno0": "전면도수",
	// 	"colorno0add": "전면도수추가"
	// };
	//
	// // 2025/05/07 추가 // 재귀 함수로 key값을 한글로 변환
	// function translateKeys(obj) {
	// 	if (Array.isArray(obj)) {
	// 		return obj.map(translateKeys); // 배열이면 내부 요소 각각 재귀
	// 	} else if (typeof obj === 'object' && obj !== null) {
	// 		return Object.entries(obj).reduce((acc, [key, val]) => {
	// 			acc[keyMap[key] || key] = translateKeys(val); // 키 바꾸고 값 재귀
	// 			return acc;
	// 		}, {});
	// 	}
	// 	return obj; // 기본 값(string, number 등)은 그대로 반환
	// }

	// ------------------

	function rst_sample_add(data){ // 2025/04/23 조재만 추가 // Sample 버튼
    	console.log('##### rst_sample_add..!');
    	console.log(data);
    	if(data.cnt==1){
    		alert('샘플 바구니에 담았습니다.');
    		if(confirm('샘플 바구니로 이동하시겠습니까?')){
    			location.href="/mypage/sample/list";
    		}
    	}
    }


    function rst_cart_add(data){
    	console.log('##### rst_cart_add..!');
    	console.log(data);
    	if(data.cnt==1){
    		alert('바구니에 담았습니다.');
    		if(confirm('바구니로 이동하시겠습니까?')){
    			location.href="/mypage/cart/list";
    		}
    	}
    }

	// 2025/05/08 조재만 추가 // paperlist에서 지질 이름 추출
	function findPaperName(prodno, paperno) {
		const prod = prods.find(p => p.prodno == prodno);
		if (!prod || !prod.paperinfo) return '-';

		for (const pinfo of prod.paperinfo) {
			const match = pinfo.paperlist.find(p => p.paperno == paperno);
			if (match) return match.papername;
		}
		return '-';

	}


</script>

		<!--	//content	-->
		<!--	footer	-->
		
<!-- user footer.jsp -->
		<!--	//footer	-->




</body></html>