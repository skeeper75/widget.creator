# 데이터 관리

Excel import/export, 일괄 작업, 검증, 감사 추적을 설명합니다.

> **핵심**: 대량 상품/가격 데이터를 Excel로 가져오고 내보낼 수 있습니다.

<Callout type="warning">
**백업**: 일괄 가져오기/삭제 작업 전에 항상 백업하세요.
</Callout>

## 1. Excel Import

### 1.1 지원 형식

**Product master**:
- `.xlsx` 형식
- 13 시트 (카테고리별 12개 + 마스터)
- 12개 카테고리

**Price table**:
- `.xlsx` 형식
- 18시트
- 수량 계단 열

### 1.2 Import 워크플로우

<Steps>
### Step 1: [Excel Import] 버튼 클릭

### Step 2: 파일 및 import 타입 선택

product master 또는 price table

### Step 3: 자동 열 매핑 검토

### Step 4: 데이터 검증

시스템이 자동 검사 실행

### Step 5: 검증 리뷰 보고

에러/경고 수, 영향받은 행

### Step 6: Import 확인
</Steps>

<Callout type="warning">
**Import는 기존 데이터를 덮어씁니다**. 상품 키로 일치하는 항목을 덮어씁니다. 항상 백업부터!
</Callout>

## 2. Excel Export

### 2.1 Export 타입

- Product data
- Pricing tables
- Constraint rules

### 2.2 필터 옵션

- 카테고리별
- 상품 타입별
- 활성/비활성 상태
- 날짜 범위

### 2.3 Export 형식

`.xlsx` 형식, 포맷된 헤더

## 3. 일괄 작업

### 3.1 다중 선택 상품

Navigator에서 Ctrl+Click 또는 Shift+Click

### 3.2 일괄 상태 토글

활성/비활성

### 3.3 일괄 카테고리 재할당

### 3.4 일괄 템플릿 적용

G1-G8

<Callout type="info">
**감사 추적**: 모든 일괄 작업은 감사 추적에 기록됩니다.
</Callout>

## 4. 데이터 검증

### 4.1 자동 검증 검사

가져오기 시 자동 실행:

- 필수 필드 존재
- 데이터 타입 정확성
- 참조 무결성 (카테고리 ID, 옵션 키)
- 유일성 제약조건 (MES 코드, 상품별 옵션 키)

### 4.2 검증 보고

- 에러 수
- 경고 수
- 영향받은 행

### 4.3 수정-재가져오기 워크플로우

에러 수정 → 재검증 → 재가져오기

## 5. 백업 및 복구

### 5.1 내보내기 전체 데이터세트

주요 작업 전 백업

### 5.2 정기 백업 권장 일정

- 일일: 자동 증분 백업
- 주간: 전체 백업
- 월간: 장기 보관 백업

<Callout type="warning">
**권장**: 일괄 가져오기 또는 삭제 전 정기 백업을 권장합니다.
</Callout>

## 6. 감사 추적

모든 CRUD 작업 기록:

- 사용자 ID
- 액션 타입
- 타임스탬프
- Before/After 상태

**기능**:
- 상품별 변경 이력
- 날짜 범위, 액션 타입, 사용자별 필터링

## 관련 문서

- [상품 관리](./product-management) - 상품 CRUD
- [가격 규칙](./price-rules) - 가격 테이블 관리
